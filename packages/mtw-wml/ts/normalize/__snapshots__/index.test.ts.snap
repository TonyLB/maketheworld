// Jest Snapshot v1, https://goo.gl/fbAQLP

exports[`WML normalize delete method should cascade deletes when removing an appearance with contents 1`] = `
Object {
  "Test": Object {
    "Story": false,
    "appearances": Array [
      Object {
        "children": Array [
          Object {
            "children": Array [],
            "data": Object {
              "index": 0,
              "key": "testVar",
              "tag": "Variable",
            },
          },
          Object {
            "children": Array [],
            "data": Object {
              "index": 0,
              "key": "testOne",
              "tag": "Room",
            },
          },
          Object {
            "children": Array [],
            "data": Object {
              "index": 0,
              "key": "testTwo",
              "tag": "Room",
            },
          },
        ],
        "contextStack": Array [],
        "data": Object {
          "Story": undefined,
          "contents": Array [],
          "key": "Test",
          "tag": "Asset",
        },
      },
    ],
    "fileName": undefined,
    "instance": false,
    "key": "Test",
    "tag": "Asset",
    "zone": undefined,
  },
  "testOne": Object {
    "appearances": Array [
      Object {
        "children": Array [
          Object {
            "children": Array [
              Object {
                "children": Array [],
                "data": Object {
                  "tag": "String",
                  "value": "One",
                },
              },
            ],
            "data": Object {
              "contents": Array [],
              "tag": "Description",
            },
          },
        ],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "Test",
            "tag": "Asset",
          },
        ],
        "data": Object {
          "contents": Array [],
          "key": "testOne",
          "name": Array [],
          "render": Array [
            Object {
              "tag": "String",
              "value": "One",
            },
          ],
          "tag": "Room",
          "x": undefined,
          "y": undefined,
        },
        "name": Array [],
        "render": Array [
          Object {
            "tag": "String",
            "value": "One",
          },
        ],
      },
    ],
    "key": "testOne",
    "tag": "Room",
  },
  "testTwo": Object {
    "appearances": Array [
      Object {
        "children": Array [],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "Test",
            "tag": "Asset",
          },
        ],
        "data": Object {
          "contents": Array [],
          "key": "testTwo",
          "name": Array [],
          "render": Array [],
          "tag": "Room",
          "x": undefined,
          "y": undefined,
        },
        "name": Array [],
        "render": Array [],
      },
    ],
    "key": "testTwo",
    "tag": "Room",
  },
  "testVar": Object {
    "appearances": Array [
      Object {
        "children": Array [],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "Test",
            "tag": "Asset",
          },
        ],
        "data": Object {
          "default": "false",
          "key": "testVar",
          "tag": "Variable",
        },
      },
    ],
    "default": "false",
    "key": "testVar",
    "tag": "Variable",
  },
}
`;

exports[`WML normalize delete method should delete an import 1`] = `
Object {
  "TestAsset": Object {
    "Story": false,
    "appearances": Array [
      Object {
        "children": Array [],
        "contextStack": Array [],
        "data": Object {
          "Story": undefined,
          "contents": Array [],
          "key": "TestAsset",
          "tag": "Asset",
        },
      },
    ],
    "fileName": undefined,
    "instance": false,
    "key": "TestAsset",
    "tag": "Asset",
    "zone": undefined,
  },
}
`;

exports[`WML normalize delete method should delete empty parent conditions 1`] = `
Object {
  "TestAsset": Object {
    "Story": false,
    "appearances": Array [
      Object {
        "children": Array [
          Object {
            "children": Array [],
            "data": Object {
              "index": 0,
              "key": "testVar",
              "tag": "Variable",
            },
          },
        ],
        "contextStack": Array [],
        "data": Object {
          "Story": undefined,
          "contents": Array [],
          "key": "TestAsset",
          "tag": "Asset",
        },
      },
    ],
    "fileName": undefined,
    "instance": false,
    "key": "TestAsset",
    "tag": "Asset",
    "zone": undefined,
  },
  "testVar": Object {
    "appearances": Array [
      Object {
        "children": Array [],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "TestAsset",
            "tag": "Asset",
          },
        ],
        "data": Object {
          "default": "false",
          "key": "testVar",
          "tag": "Variable",
        },
      },
    ],
    "default": "false",
    "key": "testVar",
    "tag": "Variable",
  },
}
`;

exports[`WML normalize delete method should remove a single appearance 1`] = `
Object {
  "Test": Object {
    "Story": false,
    "appearances": Array [
      Object {
        "children": Array [
          Object {
            "children": Array [],
            "data": Object {
              "index": 0,
              "key": "test",
              "tag": "Room",
            },
          },
        ],
        "contextStack": Array [],
        "data": Object {
          "Story": undefined,
          "contents": Array [],
          "key": "Test",
          "tag": "Asset",
        },
      },
    ],
    "fileName": undefined,
    "instance": false,
    "key": "Test",
    "tag": "Asset",
    "zone": undefined,
  },
  "test": Object {
    "appearances": Array [
      Object {
        "children": Array [
          Object {
            "children": Array [
              Object {
                "children": Array [],
                "data": Object {
                  "tag": "String",
                  "value": "One",
                },
              },
            ],
            "data": Object {
              "contents": Array [],
              "tag": "Description",
            },
          },
        ],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "Test",
            "tag": "Asset",
          },
        ],
        "data": Object {
          "contents": Array [],
          "key": "test",
          "name": Array [],
          "render": Array [
            Object {
              "tag": "String",
              "value": "One",
            },
          ],
          "tag": "Room",
          "x": undefined,
          "y": undefined,
        },
        "name": Array [],
        "render": Array [
          Object {
            "tag": "String",
            "value": "One",
          },
        ],
      },
    ],
    "key": "test",
    "tag": "Room",
  },
}
`;

exports[`WML normalize delete method should remove the entire element on removing last appearance 1`] = `
Object {
  "Test": Object {
    "Story": false,
    "appearances": Array [
      Object {
        "children": Array [],
        "contextStack": Array [],
        "data": Object {
          "Story": undefined,
          "contents": Array [],
          "key": "Test",
          "tag": "Asset",
        },
      },
    ],
    "fileName": undefined,
    "instance": false,
    "key": "Test",
    "tag": "Asset",
    "zone": undefined,
  },
}
`;

exports[`WML normalize delete method should rename synthetic keys to fill in gaps for deleted conditionals 1`] = `
Object {
  "If-0": Object {
    "appearances": Array [
      Object {
        "children": Array [
          Object {
            "children": Array [],
            "data": Object {
              "index": 0,
              "key": "testOne",
              "tag": "Room",
            },
          },
        ],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "Test",
            "tag": "Asset",
          },
        ],
        "data": Object {
          "conditions": Array [
            Object {
              "dependencies": Array [
                "testVarOne",
              ],
              "if": "testVarOne",
            },
          ],
          "contents": Array [],
          "tag": "If",
        },
      },
    ],
    "conditions": Array [
      Object {
        "dependencies": Array [
          "testVarOne",
        ],
        "if": "testVarOne",
      },
    ],
    "key": "If-0",
    "tag": "If",
  },
  "If-1": Object {
    "appearances": Array [
      Object {
        "children": Array [
          Object {
            "children": Array [],
            "data": Object {
              "index": 1,
              "key": "testOne",
              "tag": "Room",
            },
          },
        ],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "Test",
            "tag": "Asset",
          },
        ],
        "data": Object {
          "conditions": Array [
            Object {
              "dependencies": Array [
                "testVarThree",
              ],
              "if": "testVarThree",
            },
          ],
          "contents": Array [],
          "tag": "If",
        },
      },
    ],
    "conditions": Array [
      Object {
        "dependencies": Array [
          "testVarThree",
        ],
        "if": "testVarThree",
      },
    ],
    "key": "If-1",
    "tag": "If",
  },
  "Test": Object {
    "Story": false,
    "appearances": Array [
      Object {
        "children": Array [
          Object {
            "children": Array [],
            "data": Object {
              "index": 0,
              "key": "testVarOne",
              "tag": "Variable",
            },
          },
          Object {
            "children": Array [],
            "data": Object {
              "index": 0,
              "key": "testVarTwo",
              "tag": "Variable",
            },
          },
          Object {
            "children": Array [],
            "data": Object {
              "index": 0,
              "key": "testVarThree",
              "tag": "Variable",
            },
          },
          Object {
            "children": Array [],
            "data": Object {
              "index": 0,
              "key": "If-0",
              "tag": "If",
            },
          },
          Object {
            "children": Array [],
            "data": Object {
              "index": 0,
              "key": "If-1",
              "tag": "If",
            },
          },
        ],
        "contextStack": Array [],
        "data": Object {
          "Story": undefined,
          "contents": Array [],
          "key": "Test",
          "tag": "Asset",
        },
      },
    ],
    "fileName": undefined,
    "instance": false,
    "key": "Test",
    "tag": "Asset",
    "zone": undefined,
  },
  "testOne": Object {
    "appearances": Array [
      Object {
        "children": Array [
          Object {
            "children": Array [
              Object {
                "children": Array [],
                "data": Object {
                  "tag": "String",
                  "value": "One",
                },
              },
            ],
            "data": Object {
              "contents": Array [],
              "tag": "Description",
            },
          },
        ],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "Test",
            "tag": "Asset",
          },
          Object {
            "index": 0,
            "key": "If-0",
            "tag": "If",
          },
        ],
        "data": Object {
          "contents": Array [],
          "key": "testOne",
          "name": Array [],
          "render": Array [
            Object {
              "tag": "String",
              "value": "One",
            },
          ],
          "tag": "Room",
          "x": undefined,
          "y": undefined,
        },
        "name": Array [],
        "render": Array [
          Object {
            "tag": "String",
            "value": "One",
          },
        ],
      },
      Object {
        "children": Array [
          Object {
            "children": Array [
              Object {
                "children": Array [],
                "data": Object {
                  "tag": "String",
                  "value": "Three",
                },
              },
            ],
            "data": Object {
              "contents": Array [],
              "tag": "Description",
            },
          },
        ],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "Test",
            "tag": "Asset",
          },
          Object {
            "index": 0,
            "key": "If-1",
            "tag": "If",
          },
        ],
        "data": Object {
          "contents": Array [],
          "key": "testOne",
          "name": Array [],
          "render": Array [
            Object {
              "tag": "String",
              "value": "Three",
            },
          ],
          "tag": "Room",
          "x": undefined,
          "y": undefined,
        },
        "name": Array [],
        "render": Array [
          Object {
            "tag": "String",
            "value": "Three",
          },
        ],
      },
    ],
    "key": "testOne",
    "tag": "Room",
  },
  "testVarOne": Object {
    "appearances": Array [
      Object {
        "children": Array [],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "Test",
            "tag": "Asset",
          },
        ],
        "data": Object {
          "default": "false",
          "key": "testVarOne",
          "tag": "Variable",
        },
      },
    ],
    "default": "false",
    "key": "testVarOne",
    "tag": "Variable",
  },
  "testVarThree": Object {
    "appearances": Array [
      Object {
        "children": Array [],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "Test",
            "tag": "Asset",
          },
        ],
        "data": Object {
          "default": "false",
          "key": "testVarThree",
          "tag": "Variable",
        },
      },
    ],
    "default": "false",
    "key": "testVarThree",
    "tag": "Variable",
  },
  "testVarTwo": Object {
    "appearances": Array [
      Object {
        "children": Array [],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "Test",
            "tag": "Asset",
          },
        ],
        "data": Object {
          "default": "false",
          "key": "testVarTwo",
          "tag": "Variable",
        },
      },
    ],
    "default": "false",
    "key": "testVarTwo",
    "tag": "Variable",
  },
}
`;

exports[`WML normalize positioned put method should add Knowledge to an asset 1`] = `
Object {
  "Test": Object {
    "Story": false,
    "appearances": Array [
      Object {
        "children": Array [
          Object {
            "children": Array [],
            "data": Object {
              "index": 0,
              "key": "testKnowledge",
              "tag": "Knowledge",
            },
          },
        ],
        "contextStack": Array [],
        "data": Object {
          "Story": undefined,
          "contents": Array [],
          "key": "Test",
          "tag": "Asset",
        },
      },
    ],
    "fileName": undefined,
    "instance": false,
    "key": "Test",
    "tag": "Asset",
    "zone": undefined,
  },
  "testKnowledge": Object {
    "appearances": Array [
      Object {
        "children": Array [
          Object {
            "children": Array [
              Object {
                "children": Array [],
                "data": Object {
                  "tag": "String",
                  "value": "Knowledge is power",
                },
              },
            ],
            "data": Object {
              "contents": Array [],
              "tag": "Name",
            },
          },
          Object {
            "children": Array [
              Object {
                "children": Array [],
                "data": Object {
                  "tag": "String",
                  "value": "Learning!",
                },
              },
            ],
            "data": Object {
              "contents": Array [],
              "tag": "Description",
            },
          },
        ],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "Test",
            "tag": "Asset",
          },
        ],
        "data": Object {
          "contents": Array [],
          "key": "testKnowledge",
          "name": Array [
            Object {
              "tag": "String",
              "value": "Knowledge is power",
            },
          ],
          "render": Array [
            Object {
              "tag": "String",
              "value": "Learning!",
            },
          ],
          "tag": "Knowledge",
        },
        "name": Array [
          Object {
            "tag": "String",
            "value": "Knowledge is power",
          },
        ],
        "render": Array [
          Object {
            "tag": "String",
            "value": "Learning!",
          },
        ],
      },
    ],
    "key": "testKnowledge",
    "tag": "Knowledge",
  },
}
`;

exports[`WML normalize positioned put method should add an item between two others 1`] = `
Object {
  "Test": Object {
    "Story": false,
    "appearances": Array [
      Object {
        "children": Array [
          Object {
            "children": Array [],
            "data": Object {
              "index": 0,
              "key": "test",
              "tag": "Room",
            },
          },
          Object {
            "children": Array [],
            "data": Object {
              "index": 1,
              "key": "test",
              "tag": "Room",
            },
          },
          Object {
            "children": Array [],
            "data": Object {
              "index": 2,
              "key": "test",
              "tag": "Room",
            },
          },
        ],
        "contextStack": Array [],
        "data": Object {
          "Story": undefined,
          "contents": Array [],
          "key": "Test",
          "tag": "Asset",
        },
      },
    ],
    "fileName": undefined,
    "instance": false,
    "key": "Test",
    "tag": "Asset",
    "zone": undefined,
  },
  "test": Object {
    "appearances": Array [
      Object {
        "children": Array [
          Object {
            "children": Array [
              Object {
                "children": Array [],
                "data": Object {
                  "tag": "String",
                  "value": "One",
                },
              },
            ],
            "data": Object {
              "contents": Array [],
              "tag": "Description",
            },
          },
        ],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "Test",
            "tag": "Asset",
          },
        ],
        "data": Object {
          "contents": Array [],
          "key": "test",
          "name": Array [],
          "render": Array [
            Object {
              "tag": "String",
              "value": "One",
            },
          ],
          "tag": "Room",
          "x": undefined,
          "y": undefined,
        },
        "name": Array [],
        "render": Array [
          Object {
            "tag": "String",
            "value": "One",
          },
        ],
      },
      Object {
        "children": Array [
          Object {
            "children": Array [
              Object {
                "children": Array [],
                "data": Object {
                  "tag": "String",
                  "value": "Two",
                },
              },
            ],
            "data": Object {
              "contents": Array [],
              "tag": "Description",
            },
          },
        ],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "Test",
            "tag": "Asset",
          },
        ],
        "data": Object {
          "contents": Array [],
          "key": "test",
          "name": Array [],
          "render": Array [
            Object {
              "tag": "String",
              "value": "Two",
            },
          ],
          "tag": "Room",
          "x": undefined,
          "y": undefined,
        },
        "name": Array [],
        "render": Array [
          Object {
            "tag": "String",
            "value": "Two",
          },
        ],
      },
      Object {
        "children": Array [
          Object {
            "children": Array [
              Object {
                "children": Array [],
                "data": Object {
                  "tag": "String",
                  "value": "Three",
                },
              },
            ],
            "data": Object {
              "contents": Array [],
              "tag": "Description",
            },
          },
        ],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "Test",
            "tag": "Asset",
          },
        ],
        "data": Object {
          "contents": Array [],
          "key": "test",
          "name": Array [],
          "render": Array [
            Object {
              "tag": "String",
              "value": "Three",
            },
          ],
          "tag": "Room",
          "x": undefined,
          "y": undefined,
        },
        "name": Array [],
        "render": Array [
          Object {
            "tag": "String",
            "value": "Three",
          },
        ],
      },
    ],
    "key": "test",
    "tag": "Room",
  },
}
`;

exports[`WML normalize positioned put method should correctly reorder when added item is nested 1`] = `
Object {
  "Test": Object {
    "Story": false,
    "appearances": Array [
      Object {
        "children": Array [
          Object {
            "children": Array [],
            "data": Object {
              "index": 0,
              "key": "test",
              "tag": "Room",
            },
          },
          Object {
            "children": Array [],
            "data": Object {
              "index": 0,
              "key": "testMap",
              "tag": "Map",
            },
          },
          Object {
            "children": Array [],
            "data": Object {
              "index": 2,
              "key": "test",
              "tag": "Room",
            },
          },
        ],
        "contextStack": Array [],
        "data": Object {
          "Story": undefined,
          "contents": Array [],
          "key": "Test",
          "tag": "Asset",
        },
      },
    ],
    "fileName": undefined,
    "instance": false,
    "key": "Test",
    "tag": "Asset",
    "zone": undefined,
  },
  "test": Object {
    "appearances": Array [
      Object {
        "children": Array [
          Object {
            "children": Array [
              Object {
                "children": Array [],
                "data": Object {
                  "tag": "String",
                  "value": "One",
                },
              },
            ],
            "data": Object {
              "contents": Array [],
              "tag": "Description",
            },
          },
        ],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "Test",
            "tag": "Asset",
          },
        ],
        "data": Object {
          "contents": Array [],
          "key": "test",
          "name": Array [],
          "render": Array [
            Object {
              "tag": "String",
              "value": "One",
            },
          ],
          "tag": "Room",
          "x": undefined,
          "y": undefined,
        },
        "name": Array [],
        "render": Array [
          Object {
            "tag": "String",
            "value": "One",
          },
        ],
      },
      Object {
        "children": Array [
          Object {
            "children": Array [
              Object {
                "children": Array [],
                "data": Object {
                  "tag": "String",
                  "value": "Two",
                },
              },
            ],
            "data": Object {
              "contents": Array [],
              "tag": "Description",
            },
          },
        ],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "Test",
            "tag": "Asset",
          },
          Object {
            "index": 0,
            "key": "testMap",
            "tag": "Map",
          },
        ],
        "data": Object {
          "contents": Array [],
          "key": "test",
          "name": Array [],
          "render": Array [
            Object {
              "tag": "String",
              "value": "Two",
            },
          ],
          "tag": "Room",
          "x": 0,
          "y": 0,
        },
        "name": Array [],
        "render": Array [
          Object {
            "tag": "String",
            "value": "Two",
          },
        ],
        "x": 0,
        "y": 0,
      },
      Object {
        "children": Array [
          Object {
            "children": Array [
              Object {
                "children": Array [],
                "data": Object {
                  "tag": "String",
                  "value": "Three",
                },
              },
            ],
            "data": Object {
              "contents": Array [],
              "tag": "Description",
            },
          },
        ],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "Test",
            "tag": "Asset",
          },
        ],
        "data": Object {
          "contents": Array [],
          "key": "test",
          "name": Array [],
          "render": Array [
            Object {
              "tag": "String",
              "value": "Three",
            },
          ],
          "tag": "Room",
          "x": undefined,
          "y": undefined,
        },
        "name": Array [],
        "render": Array [
          Object {
            "tag": "String",
            "value": "Three",
          },
        ],
      },
    ],
    "key": "test",
    "tag": "Room",
  },
  "testMap": Object {
    "appearances": Array [
      Object {
        "children": Array [
          Object {
            "children": Array [],
            "data": Object {
              "index": 1,
              "key": "test",
              "tag": "Room",
            },
          },
        ],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "Test",
            "tag": "Asset",
          },
        ],
        "data": Object {
          "contents": Array [],
          "images": Array [],
          "key": "testMap",
          "name": Array [],
          "rooms": Array [
            Object {
              "conditions": Array [],
              "key": "test",
              "x": 0,
              "y": 0,
            },
          ],
          "tag": "Map",
        },
        "images": Array [],
        "name": Array [],
        "rooms": Array [
          Object {
            "conditions": Array [],
            "key": "test",
            "x": 0,
            "y": 0,
          },
        ],
      },
    ],
    "key": "testMap",
    "tag": "Map",
  },
}
`;

exports[`WML normalize positioned put method should recalculate Map rooms property on contents update 1`] = `
Object {
  "Test": Object {
    "Story": false,
    "appearances": Array [
      Object {
        "children": Array [
          Object {
            "children": Array [],
            "data": Object {
              "index": 0,
              "key": "testMap",
              "tag": "Map",
            },
          },
        ],
        "contextStack": Array [],
        "data": Object {
          "Story": undefined,
          "contents": Array [],
          "key": "Test",
          "tag": "Asset",
        },
      },
    ],
    "fileName": undefined,
    "instance": false,
    "key": "Test",
    "tag": "Asset",
    "zone": undefined,
  },
  "test": Object {
    "appearances": Array [
      Object {
        "children": Array [],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "Test",
            "tag": "Asset",
          },
          Object {
            "index": 0,
            "key": "testMap",
            "tag": "Map",
          },
        ],
        "data": Object {
          "contents": Array [],
          "key": "test",
          "name": Array [],
          "render": Array [],
          "tag": "Room",
          "x": 0,
          "y": 0,
        },
        "name": Array [],
        "render": Array [],
        "x": 0,
        "y": 0,
      },
    ],
    "key": "test",
    "tag": "Room",
  },
  "testMap": Object {
    "appearances": Array [
      Object {
        "children": Array [
          Object {
            "children": Array [],
            "data": Object {
              "index": 0,
              "key": "test",
              "tag": "Room",
            },
          },
          Object {
            "children": Array [],
            "data": Object {
              "index": 0,
              "key": "testTwo",
              "tag": "Room",
            },
          },
        ],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "Test",
            "tag": "Asset",
          },
        ],
        "data": Object {
          "contents": Array [],
          "images": Array [],
          "key": "testMap",
          "name": Array [],
          "rooms": Array [
            Object {
              "conditions": Array [],
              "key": "test",
              "x": 0,
              "y": 0,
            },
          ],
          "tag": "Map",
        },
        "images": Array [],
        "name": Array [],
        "rooms": Array [
          Object {
            "conditions": Array [],
            "key": "test",
            "x": 0,
            "y": 0,
          },
          Object {
            "conditions": Array [],
            "key": "testTwo",
            "x": 0,
            "y": 100,
          },
        ],
      },
    ],
    "key": "testMap",
    "tag": "Map",
  },
  "testTwo": Object {
    "appearances": Array [
      Object {
        "children": Array [],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "Test",
            "tag": "Asset",
          },
          Object {
            "index": 0,
            "key": "testMap",
            "tag": "Map",
          },
        ],
        "data": Object {
          "contents": Array [],
          "key": "testTwo",
          "name": Array [],
          "render": Array [],
          "tag": "Room",
          "x": 0,
          "y": 100,
        },
        "name": Array [],
        "render": Array [],
        "x": 0,
        "y": 100,
      },
    ],
    "key": "testTwo",
    "tag": "Room",
  },
}
`;

exports[`WML normalize positioned put method should recalculate Variable default property on update 1`] = `
Object {
  "Test": Object {
    "Story": false,
    "appearances": Array [
      Object {
        "children": Array [
          Object {
            "children": Array [],
            "data": Object {
              "index": 0,
              "key": "testVar",
              "tag": "Variable",
            },
          },
        ],
        "contextStack": Array [],
        "data": Object {
          "Story": undefined,
          "contents": Array [],
          "key": "Test",
          "tag": "Asset",
        },
      },
    ],
    "fileName": undefined,
    "instance": false,
    "key": "Test",
    "tag": "Asset",
    "zone": undefined,
  },
  "testVar": Object {
    "appearances": Array [
      Object {
        "children": Array [],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "Test",
            "tag": "Asset",
          },
        ],
        "data": Object {
          "default": "true",
          "key": "testVar",
          "tag": "Variable",
        },
      },
    ],
    "default": "true",
    "key": "testVar",
    "tag": "Variable",
  },
}
`;

exports[`WML normalize positioned put method should replace a nest that includes an item with the item itself 1`] = `
Object {
  "Test": Object {
    "Story": false,
    "appearances": Array [
      Object {
        "children": Array [
          Object {
            "children": Array [],
            "data": Object {
              "index": 0,
              "key": "test",
              "tag": "Room",
            },
          },
          Object {
            "children": Array [],
            "data": Object {
              "index": 1,
              "key": "test",
              "tag": "Room",
            },
          },
          Object {
            "children": Array [],
            "data": Object {
              "index": 2,
              "key": "test",
              "tag": "Room",
            },
          },
        ],
        "contextStack": Array [],
        "data": Object {
          "Story": undefined,
          "contents": Array [],
          "key": "Test",
          "tag": "Asset",
        },
      },
    ],
    "fileName": undefined,
    "instance": false,
    "key": "Test",
    "tag": "Asset",
    "zone": undefined,
  },
  "test": Object {
    "appearances": Array [
      Object {
        "children": Array [
          Object {
            "children": Array [
              Object {
                "children": Array [],
                "data": Object {
                  "tag": "String",
                  "value": "One",
                },
              },
            ],
            "data": Object {
              "contents": Array [],
              "tag": "Description",
            },
          },
        ],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "Test",
            "tag": "Asset",
          },
        ],
        "data": Object {
          "contents": Array [],
          "key": "test",
          "name": Array [],
          "render": Array [
            Object {
              "tag": "String",
              "value": "One",
            },
          ],
          "tag": "Room",
          "x": undefined,
          "y": undefined,
        },
        "name": Array [],
        "render": Array [
          Object {
            "tag": "String",
            "value": "One",
          },
        ],
      },
      Object {
        "children": Array [
          Object {
            "children": Array [
              Object {
                "children": Array [],
                "data": Object {
                  "tag": "String",
                  "value": "Two",
                },
              },
            ],
            "data": Object {
              "contents": Array [],
              "tag": "Description",
            },
          },
        ],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "Test",
            "tag": "Asset",
          },
        ],
        "data": Object {
          "contents": Array [],
          "key": "test",
          "name": Array [],
          "render": Array [
            Object {
              "tag": "String",
              "value": "Two",
            },
          ],
          "tag": "Room",
          "x": undefined,
          "y": undefined,
        },
        "name": Array [],
        "render": Array [
          Object {
            "tag": "String",
            "value": "Two",
          },
        ],
      },
      Object {
        "children": Array [
          Object {
            "children": Array [
              Object {
                "children": Array [],
                "data": Object {
                  "tag": "String",
                  "value": "Three",
                },
              },
            ],
            "data": Object {
              "contents": Array [],
              "tag": "Description",
            },
          },
        ],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "Test",
            "tag": "Asset",
          },
        ],
        "data": Object {
          "contents": Array [],
          "key": "test",
          "name": Array [],
          "render": Array [
            Object {
              "tag": "String",
              "value": "Three",
            },
          ],
          "tag": "Room",
          "x": undefined,
          "y": undefined,
        },
        "name": Array [],
        "render": Array [
          Object {
            "tag": "String",
            "value": "Three",
          },
        ],
      },
    ],
    "key": "test",
    "tag": "Room",
  },
}
`;

exports[`WML normalize positioned put method should replace a top level character item 1`] = `
Object {
  "Tess": Object {
    "FirstImpression": "Frumpy goth",
    "Name": "Tessa",
    "OneCoolThing": "Thousand yard stare",
    "Outfit": "A battered frock-coat",
    "Pronouns": Object {
      "adjective": "hers",
      "object": "her",
      "possessive": "her",
      "reflexive": "herself",
      "subject": "she",
    },
    "appearances": Array [
      Object {
        "children": Array [],
        "contextStack": Array [],
        "data": Object {
          "FirstImpression": "Frumpy goth",
          "Name": "Tessa",
          "OneCoolThing": "Thousand yard stare",
          "Outfit": "A battered frock-coat",
          "Pronouns": Object {
            "adjective": "hers",
            "object": "her",
            "possessive": "her",
            "reflexive": "herself",
            "subject": "she",
          },
          "contents": Array [],
          "key": "Tess",
          "tag": "Character",
        },
      },
    ],
    "assets": Array [],
    "fileName": undefined,
    "images": Array [],
    "key": "Tess",
    "tag": "Character",
  },
}
`;

exports[`WML normalize positioned put method should replace an item with a different item 1`] = `
Object {
  "Test": Object {
    "Story": false,
    "appearances": Array [
      Object {
        "children": Array [
          Object {
            "children": Array [],
            "data": Object {
              "index": 0,
              "key": "test",
              "tag": "Room",
            },
          },
          Object {
            "children": Array [],
            "data": Object {
              "index": 0,
              "key": "testTwo",
              "tag": "Room",
            },
          },
          Object {
            "children": Array [],
            "data": Object {
              "index": 1,
              "key": "test",
              "tag": "Room",
            },
          },
        ],
        "contextStack": Array [],
        "data": Object {
          "Story": undefined,
          "contents": Array [],
          "key": "Test",
          "tag": "Asset",
        },
      },
    ],
    "fileName": undefined,
    "instance": false,
    "key": "Test",
    "tag": "Asset",
    "zone": undefined,
  },
  "test": Object {
    "appearances": Array [
      Object {
        "children": Array [
          Object {
            "children": Array [
              Object {
                "children": Array [],
                "data": Object {
                  "tag": "String",
                  "value": "One",
                },
              },
            ],
            "data": Object {
              "contents": Array [],
              "tag": "Description",
            },
          },
        ],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "Test",
            "tag": "Asset",
          },
        ],
        "data": Object {
          "contents": Array [],
          "key": "test",
          "name": Array [],
          "render": Array [
            Object {
              "tag": "String",
              "value": "One",
            },
          ],
          "tag": "Room",
          "x": undefined,
          "y": undefined,
        },
        "name": Array [],
        "render": Array [
          Object {
            "tag": "String",
            "value": "One",
          },
        ],
      },
      Object {
        "children": Array [
          Object {
            "children": Array [
              Object {
                "children": Array [],
                "data": Object {
                  "tag": "String",
                  "value": "Two",
                },
              },
            ],
            "data": Object {
              "contents": Array [],
              "tag": "Description",
            },
          },
        ],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "Test",
            "tag": "Asset",
          },
        ],
        "data": Object {
          "contents": Array [],
          "key": "test",
          "name": Array [],
          "render": Array [
            Object {
              "tag": "String",
              "value": "Two",
            },
          ],
          "tag": "Room",
          "x": undefined,
          "y": undefined,
        },
        "name": Array [],
        "render": Array [
          Object {
            "tag": "String",
            "value": "Two",
          },
        ],
      },
    ],
    "key": "test",
    "tag": "Room",
  },
  "testTwo": Object {
    "appearances": Array [
      Object {
        "children": Array [
          Object {
            "children": Array [
              Object {
                "children": Array [],
                "data": Object {
                  "tag": "String",
                  "value": "Bar",
                },
              },
            ],
            "data": Object {
              "contents": Array [],
              "tag": "Description",
            },
          },
        ],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "Test",
            "tag": "Asset",
          },
        ],
        "data": Object {
          "contents": Array [],
          "key": "testTwo",
          "name": Array [],
          "render": Array [
            Object {
              "tag": "String",
              "value": "Bar",
            },
          ],
          "tag": "Room",
          "x": undefined,
          "y": undefined,
        },
        "name": Array [],
        "render": Array [
          Object {
            "tag": "String",
            "value": "Bar",
          },
        ],
      },
    ],
    "key": "testTwo",
    "tag": "Room",
  },
}
`;

exports[`WML normalize positioned put method should replace an item with a nest that includes the item 1`] = `
Object {
  "Test": Object {
    "Story": false,
    "appearances": Array [
      Object {
        "children": Array [
          Object {
            "children": Array [],
            "data": Object {
              "index": 0,
              "key": "test",
              "tag": "Room",
            },
          },
          Object {
            "children": Array [],
            "data": Object {
              "index": 0,
              "key": "testMap",
              "tag": "Map",
            },
          },
          Object {
            "children": Array [],
            "data": Object {
              "index": 2,
              "key": "test",
              "tag": "Room",
            },
          },
        ],
        "contextStack": Array [],
        "data": Object {
          "Story": undefined,
          "contents": Array [],
          "key": "Test",
          "tag": "Asset",
        },
      },
    ],
    "fileName": undefined,
    "instance": false,
    "key": "Test",
    "tag": "Asset",
    "zone": undefined,
  },
  "test": Object {
    "appearances": Array [
      Object {
        "children": Array [
          Object {
            "children": Array [
              Object {
                "children": Array [],
                "data": Object {
                  "tag": "String",
                  "value": "One",
                },
              },
            ],
            "data": Object {
              "contents": Array [],
              "tag": "Description",
            },
          },
        ],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "Test",
            "tag": "Asset",
          },
        ],
        "data": Object {
          "contents": Array [],
          "key": "test",
          "name": Array [],
          "render": Array [
            Object {
              "tag": "String",
              "value": "One",
            },
          ],
          "tag": "Room",
          "x": undefined,
          "y": undefined,
        },
        "name": Array [],
        "render": Array [
          Object {
            "tag": "String",
            "value": "One",
          },
        ],
      },
      Object {
        "children": Array [
          Object {
            "children": Array [
              Object {
                "children": Array [],
                "data": Object {
                  "tag": "String",
                  "value": "Two",
                },
              },
            ],
            "data": Object {
              "contents": Array [],
              "tag": "Description",
            },
          },
        ],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "Test",
            "tag": "Asset",
          },
          Object {
            "index": 0,
            "key": "testMap",
            "tag": "Map",
          },
        ],
        "data": Object {
          "contents": Array [],
          "key": "test",
          "name": Array [],
          "render": Array [
            Object {
              "tag": "String",
              "value": "Two",
            },
          ],
          "tag": "Room",
          "x": 0,
          "y": 0,
        },
        "name": Array [],
        "render": Array [
          Object {
            "tag": "String",
            "value": "Two",
          },
        ],
        "x": 0,
        "y": 0,
      },
      Object {
        "children": Array [
          Object {
            "children": Array [
              Object {
                "children": Array [],
                "data": Object {
                  "tag": "String",
                  "value": "Three",
                },
              },
            ],
            "data": Object {
              "contents": Array [],
              "tag": "Description",
            },
          },
        ],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "Test",
            "tag": "Asset",
          },
        ],
        "data": Object {
          "contents": Array [],
          "key": "test",
          "name": Array [],
          "render": Array [
            Object {
              "tag": "String",
              "value": "Three",
            },
          ],
          "tag": "Room",
          "x": undefined,
          "y": undefined,
        },
        "name": Array [],
        "render": Array [
          Object {
            "tag": "String",
            "value": "Three",
          },
        ],
      },
    ],
    "key": "test",
    "tag": "Room",
  },
  "testMap": Object {
    "appearances": Array [
      Object {
        "children": Array [
          Object {
            "children": Array [],
            "data": Object {
              "index": 1,
              "key": "test",
              "tag": "Room",
            },
          },
        ],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "Test",
            "tag": "Asset",
          },
        ],
        "data": Object {
          "contents": Array [],
          "images": Array [],
          "key": "testMap",
          "name": Array [],
          "rooms": Array [
            Object {
              "conditions": Array [],
              "key": "test",
              "x": 0,
              "y": 0,
            },
          ],
          "tag": "Map",
        },
        "images": Array [],
        "name": Array [],
        "rooms": Array [
          Object {
            "conditions": Array [],
            "key": "test",
            "x": 0,
            "y": 0,
          },
        ],
      },
    ],
    "key": "testMap",
    "tag": "Map",
  },
}
`;

exports[`WML normalize positioned put method should replace nested internal conditions 1`] = `
Object {
  "If-0": Object {
    "appearances": Array [
      Object {
        "children": Array [
          Object {
            "children": Array [],
            "data": Object {
              "index": 0,
              "key": "testTwo",
              "tag": "Room",
            },
          },
        ],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "Test",
            "tag": "Asset",
          },
          Object {
            "index": 0,
            "key": "testMap",
            "tag": "Map",
          },
        ],
        "data": Object {
          "conditions": Array [
            Object {
              "dependencies": Array [],
              "if": "true",
            },
          ],
          "contents": Array [],
          "tag": "If",
        },
      },
      Object {
        "children": Array [
          Object {
            "children": Array [],
            "data": Object {
              "index": 1,
              "key": "testMap",
              "tag": "Map",
            },
          },
        ],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "Test",
            "tag": "Asset",
          },
        ],
        "data": Object {
          "conditions": Array [
            Object {
              "dependencies": Array [],
              "if": "true",
            },
          ],
          "contents": Array [],
          "tag": "If",
        },
      },
    ],
    "conditions": Array [
      Object {
        "dependencies": Array [],
        "if": "true",
      },
    ],
    "key": "If-0",
    "tag": "If",
  },
  "Test": Object {
    "Story": false,
    "appearances": Array [
      Object {
        "children": Array [
          Object {
            "children": Array [],
            "data": Object {
              "index": 0,
              "key": "testMap",
              "tag": "Map",
            },
          },
          Object {
            "children": Array [],
            "data": Object {
              "index": 1,
              "key": "If-0",
              "tag": "If",
            },
          },
        ],
        "contextStack": Array [],
        "data": Object {
          "Story": undefined,
          "contents": Array [],
          "key": "Test",
          "tag": "Asset",
        },
      },
    ],
    "fileName": undefined,
    "instance": false,
    "key": "Test",
    "tag": "Asset",
    "zone": undefined,
  },
  "test": Object {
    "appearances": Array [
      Object {
        "children": Array [
          Object {
            "children": Array [
              Object {
                "children": Array [],
                "data": Object {
                  "tag": "String",
                  "value": "One",
                },
              },
            ],
            "data": Object {
              "contents": Array [],
              "tag": "Description",
            },
          },
        ],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "Test",
            "tag": "Asset",
          },
          Object {
            "index": 0,
            "key": "testMap",
            "tag": "Map",
          },
        ],
        "data": Object {
          "contents": Array [],
          "key": "test",
          "name": Array [],
          "render": Array [
            Object {
              "tag": "String",
              "value": "One",
            },
          ],
          "tag": "Room",
          "x": 0,
          "y": 100,
        },
        "name": Array [],
        "render": Array [
          Object {
            "tag": "String",
            "value": "One",
          },
        ],
        "x": 0,
        "y": 100,
      },
    ],
    "key": "test",
    "tag": "Room",
  },
  "testMap": Object {
    "appearances": Array [
      Object {
        "children": Array [
          Object {
            "children": Array [],
            "data": Object {
              "index": 0,
              "key": "test",
              "tag": "Room",
            },
          },
          Object {
            "children": Array [],
            "data": Object {
              "index": 0,
              "key": "If-0",
              "tag": "If",
            },
          },
        ],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "Test",
            "tag": "Asset",
          },
        ],
        "data": Object {
          "contents": Array [],
          "images": Array [],
          "key": "testMap",
          "name": Array [],
          "rooms": Array [
            Object {
              "conditions": Array [],
              "key": "test",
              "x": 0,
              "y": 100,
            },
            Object {
              "conditions": Array [
                Object {
                  "dependencies": Array [],
                  "if": "true",
                },
              ],
              "key": "testTwo",
              "x": 100,
              "y": 0,
            },
          ],
          "tag": "Map",
        },
        "images": Array [],
        "name": Array [],
        "rooms": Array [
          Object {
            "conditions": Array [],
            "key": "test",
            "x": 0,
            "y": 100,
          },
          Object {
            "conditions": Array [
              Object {
                "dependencies": Array [],
                "if": "true",
              },
            ],
            "key": "testTwo",
            "x": 100,
            "y": 0,
          },
        ],
      },
      Object {
        "children": Array [
          Object {
            "children": Array [],
            "data": Object {
              "index": 0,
              "key": "testThree",
              "tag": "Room",
            },
          },
        ],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "Test",
            "tag": "Asset",
          },
          Object {
            "index": 1,
            "key": "If-0",
            "tag": "If",
          },
        ],
        "data": Object {
          "contents": Array [],
          "images": Array [],
          "key": "testMap",
          "name": Array [],
          "rooms": Array [
            Object {
              "conditions": Array [],
              "key": "testThree",
              "x": -100,
              "y": 0,
            },
          ],
          "tag": "Map",
        },
        "images": Array [],
        "name": Array [],
        "rooms": Array [
          Object {
            "conditions": Array [],
            "key": "testThree",
            "x": -100,
            "y": 0,
          },
        ],
      },
    ],
    "key": "testMap",
    "tag": "Map",
  },
  "testThree": Object {
    "appearances": Array [
      Object {
        "children": Array [],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "Test",
            "tag": "Asset",
          },
          Object {
            "index": 1,
            "key": "If-0",
            "tag": "If",
          },
          Object {
            "index": 1,
            "key": "testMap",
            "tag": "Map",
          },
        ],
        "data": Object {
          "contents": Array [],
          "key": "testThree",
          "name": Array [],
          "render": Array [],
          "tag": "Room",
          "x": -100,
          "y": 0,
        },
        "name": Array [],
        "render": Array [],
        "x": -100,
        "y": 0,
      },
    ],
    "key": "testThree",
    "tag": "Room",
  },
  "testTwo": Object {
    "appearances": Array [
      Object {
        "children": Array [
          Object {
            "children": Array [
              Object {
                "children": Array [],
                "data": Object {
                  "tag": "String",
                  "value": "Two",
                },
              },
            ],
            "data": Object {
              "contents": Array [],
              "tag": "Description",
            },
          },
        ],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "Test",
            "tag": "Asset",
          },
          Object {
            "index": 0,
            "key": "testMap",
            "tag": "Map",
          },
          Object {
            "index": 0,
            "key": "If-0",
            "tag": "If",
          },
        ],
        "data": Object {
          "contents": Array [],
          "key": "testTwo",
          "name": Array [],
          "render": Array [
            Object {
              "tag": "String",
              "value": "Two",
            },
          ],
          "tag": "Room",
          "x": 100,
          "y": 0,
        },
        "name": Array [],
        "render": Array [
          Object {
            "tag": "String",
            "value": "Two",
          },
        ],
        "x": 100,
        "y": 0,
      },
    ],
    "key": "testTwo",
    "tag": "Room",
  },
}
`;

exports[`WML normalize positioned put method should successfully extend an import in place 1`] = `
Object {
  "Import-0": Object {
    "appearances": Array [
      Object {
        "children": Array [
          Object {
            "children": Array [],
            "data": Object {
              "index": 0,
              "key": "testOne",
              "tag": "Room",
            },
          },
          Object {
            "children": Array [],
            "data": Object {
              "index": 0,
              "key": "testTwo",
              "tag": "Room",
            },
          },
        ],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "TestAsset",
            "tag": "Asset",
          },
        ],
        "data": Object {
          "from": "base",
          "mapping": Object {
            "testOne": Object {
              "key": "testOne",
              "type": "Room",
            },
            "testTwo": Object {
              "key": "testTwo",
              "type": "Room",
            },
          },
          "tag": "Import",
        },
      },
    ],
    "from": "base",
    "key": "Import-0",
    "mapping": Object {
      "testOne": Object {
        "key": "testOne",
        "type": "Room",
      },
      "testTwo": Object {
        "key": "testTwo",
        "type": "Room",
      },
    },
    "tag": "Import",
  },
  "TestAsset": Object {
    "Story": false,
    "appearances": Array [
      Object {
        "children": Array [
          Object {
            "children": Array [],
            "data": Object {
              "index": 0,
              "key": "Import-0",
              "tag": "Import",
            },
          },
        ],
        "contextStack": Array [],
        "data": Object {
          "Story": undefined,
          "contents": Array [],
          "key": "TestAsset",
          "tag": "Asset",
        },
      },
    ],
    "fileName": undefined,
    "instance": false,
    "key": "TestAsset",
    "tag": "Asset",
    "zone": undefined,
  },
  "testOne": Object {
    "appearances": Array [
      Object {
        "children": Array [],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "TestAsset",
            "tag": "Asset",
          },
          Object {
            "index": 0,
            "key": "Import-0",
            "tag": "Import",
          },
        ],
        "data": Object {
          "contents": Array [],
          "from": "testOne",
          "key": "testOne",
          "name": Array [],
          "render": Array [],
          "tag": "Room",
        },
        "name": Array [],
        "render": Array [],
      },
    ],
    "key": "testOne",
    "tag": "Room",
  },
  "testTwo": Object {
    "appearances": Array [
      Object {
        "children": Array [],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "TestAsset",
            "tag": "Asset",
          },
          Object {
            "index": 0,
            "key": "Import-0",
            "tag": "Import",
          },
        ],
        "data": Object {
          "contents": Array [],
          "from": "testTwo",
          "key": "testTwo",
          "name": Array [],
          "render": Array [],
          "tag": "Room",
        },
        "name": Array [],
        "render": Array [],
      },
    ],
    "key": "testTwo",
    "tag": "Room",
  },
}
`;

exports[`WML normalize positioned put method should successfully put a duplicate item 1`] = `
Object {
  "If-1": Object {
    "appearances": Array [
      Object {
        "children": Array [],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "TestAsset",
            "tag": "Asset",
          },
          Object {
            "index": 0,
            "key": "testRoom",
            "tag": "Room",
          },
        ],
        "data": Object {
          "conditions": Array [
            Object {
              "dependencies": Array [
                "testVar",
              ],
              "if": "testVar",
            },
          ],
          "contents": Array [],
          "tag": "If",
        },
      },
      Object {
        "children": Array [
          Object {
            "children": Array [],
            "data": Object {
              "index": 0,
              "key": "testRoom#targetTwo",
              "tag": "Exit",
            },
          },
        ],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "TestAsset",
            "tag": "Asset",
          },
          Object {
            "index": 0,
            "key": "testRoom",
            "tag": "Room",
          },
        ],
        "data": Object {
          "conditions": Array [
            Object {
              "dependencies": Array [
                "testVar",
              ],
              "if": "testVar",
            },
          ],
          "contents": Array [],
          "tag": "If",
        },
      },
      Object {
        "children": Array [
          Object {
            "children": Array [],
            "data": Object {
              "index": 0,
              "key": "testRoom#targetThree",
              "tag": "Exit",
            },
          },
        ],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "TestAsset",
            "tag": "Asset",
          },
          Object {
            "index": 0,
            "key": "testRoom",
            "tag": "Room",
          },
        ],
        "data": Object {
          "conditions": Array [
            Object {
              "dependencies": Array [
                "testVar",
              ],
              "if": "testVar",
            },
          ],
          "contents": Array [],
          "tag": "If",
        },
      },
    ],
    "conditions": Array [
      Object {
        "dependencies": Array [
          "testVar",
        ],
        "if": "testVar",
      },
    ],
    "key": "If-1",
    "tag": "If",
  },
  "TestAsset": Object {
    "Story": false,
    "appearances": Array [
      Object {
        "children": Array [
          Object {
            "children": Array [],
            "data": Object {
              "index": 0,
              "key": "testVar",
              "tag": "Variable",
            },
          },
          Object {
            "children": Array [],
            "data": Object {
              "index": 0,
              "key": "testRoom",
              "tag": "Room",
            },
          },
          Object {
            "children": Array [],
            "data": Object {
              "index": 0,
              "key": "targetOne",
              "tag": "Room",
            },
          },
          Object {
            "children": Array [],
            "data": Object {
              "index": 0,
              "key": "targetTwo",
              "tag": "Room",
            },
          },
          Object {
            "children": Array [],
            "data": Object {
              "index": 0,
              "key": "targetThree",
              "tag": "Room",
            },
          },
        ],
        "contextStack": Array [],
        "data": Object {
          "Story": undefined,
          "contents": Array [],
          "key": "TestAsset",
          "tag": "Asset",
        },
      },
    ],
    "fileName": undefined,
    "instance": false,
    "key": "TestAsset",
    "tag": "Asset",
    "zone": undefined,
  },
  "targetOne": Object {
    "appearances": Array [
      Object {
        "children": Array [],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "TestAsset",
            "tag": "Asset",
          },
        ],
        "data": Object {
          "contents": Array [],
          "key": "targetOne",
          "name": Array [],
          "render": Array [],
          "tag": "Room",
          "x": undefined,
          "y": undefined,
        },
        "name": Array [],
        "render": Array [],
      },
    ],
    "key": "targetOne",
    "tag": "Room",
  },
  "targetThree": Object {
    "appearances": Array [
      Object {
        "children": Array [],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "TestAsset",
            "tag": "Asset",
          },
        ],
        "data": Object {
          "contents": Array [],
          "key": "targetThree",
          "name": Array [],
          "render": Array [],
          "tag": "Room",
          "x": undefined,
          "y": undefined,
        },
        "name": Array [],
        "render": Array [],
      },
    ],
    "key": "targetThree",
    "tag": "Room",
  },
  "targetTwo": Object {
    "appearances": Array [
      Object {
        "children": Array [],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "TestAsset",
            "tag": "Asset",
          },
        ],
        "data": Object {
          "contents": Array [],
          "key": "targetTwo",
          "name": Array [],
          "render": Array [],
          "tag": "Room",
          "x": undefined,
          "y": undefined,
        },
        "name": Array [],
        "render": Array [],
      },
    ],
    "key": "targetTwo",
    "tag": "Room",
  },
  "testRoom": Object {
    "appearances": Array [
      Object {
        "children": Array [
          Object {
            "children": Array [],
            "data": Object {
              "index": 0,
              "key": "If-1",
              "tag": "If",
            },
          },
          Object {
            "children": Array [],
            "data": Object {
              "index": 1,
              "key": "If-1",
              "tag": "If",
            },
          },
          Object {
            "children": Array [],
            "data": Object {
              "index": 2,
              "key": "If-1",
              "tag": "If",
            },
          },
        ],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "TestAsset",
            "tag": "Asset",
          },
        ],
        "data": Object {
          "contents": Array [],
          "key": "testRoom",
          "name": Array [],
          "render": Array [],
          "tag": "Room",
          "x": undefined,
          "y": undefined,
        },
        "name": Array [],
        "render": Array [],
      },
    ],
    "key": "testRoom",
    "tag": "Room",
  },
  "testRoom#targetThree": Object {
    "appearances": Array [
      Object {
        "children": Array [],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "TestAsset",
            "tag": "Asset",
          },
          Object {
            "index": 0,
            "key": "testRoom",
            "tag": "Room",
          },
          Object {
            "index": 2,
            "key": "If-1",
            "tag": "If",
          },
        ],
        "data": Object {
          "contents": Array [],
          "from": "testRoom",
          "key": "testRoom#targetThree",
          "name": "three",
          "tag": "Exit",
          "to": "targetThree",
        },
      },
    ],
    "from": "testRoom",
    "key": "testRoom#targetThree",
    "name": "three",
    "tag": "Exit",
    "to": "targetThree",
  },
  "testRoom#targetTwo": Object {
    "appearances": Array [
      Object {
        "children": Array [],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "TestAsset",
            "tag": "Asset",
          },
          Object {
            "index": 0,
            "key": "testRoom",
            "tag": "Room",
          },
          Object {
            "index": 1,
            "key": "If-1",
            "tag": "If",
          },
        ],
        "data": Object {
          "contents": Array [],
          "from": "testRoom",
          "key": "testRoom#targetTwo",
          "name": "two",
          "tag": "Exit",
          "to": "targetTwo",
        },
      },
    ],
    "from": "testRoom",
    "key": "testRoom#targetTwo",
    "name": "two",
    "tag": "Exit",
    "to": "targetTwo",
  },
  "testVar": Object {
    "appearances": Array [
      Object {
        "children": Array [],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "TestAsset",
            "tag": "Asset",
          },
        ],
        "data": Object {
          "default": "false",
          "key": "testVar",
          "tag": "Variable",
        },
      },
    ],
    "default": "false",
    "key": "testVar",
    "tag": "Variable",
  },
}
`;

exports[`WML normalize positioned put method should successfully put an import in a character 1`] = `
Object {
  "Import-0": Object {
    "appearances": Array [
      Object {
        "children": Array [],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "Tess",
            "tag": "Character",
          },
        ],
        "data": Object {
          "from": "base",
          "mapping": Object {},
          "tag": "Import",
        },
      },
    ],
    "from": "base",
    "key": "Import-0",
    "mapping": Object {},
    "tag": "Import",
  },
  "Tess": Object {
    "FirstImpression": "Frumpy goth",
    "Name": "Tess",
    "OneCoolThing": "Fuchsia eyes",
    "Outfit": "A battered frock-coat",
    "Pronouns": Object {
      "adjective": "hers",
      "object": "her",
      "possessive": "her",
      "reflexive": "herself",
      "subject": "she",
    },
    "appearances": Array [
      Object {
        "children": Array [
          Object {
            "children": Array [],
            "data": Object {
              "index": 0,
              "key": "Import-0",
              "tag": "Import",
            },
          },
        ],
        "contextStack": Array [],
        "data": Object {
          "FirstImpression": "Frumpy goth",
          "Name": "Tess",
          "OneCoolThing": "Fuchsia eyes",
          "Outfit": "A battered frock-coat",
          "Pronouns": Object {
            "adjective": "hers",
            "object": "her",
            "possessive": "her",
            "reflexive": "herself",
            "subject": "she",
          },
          "contents": Array [],
          "key": "Tess",
          "tag": "Character",
        },
      },
    ],
    "assets": Array [],
    "fileName": undefined,
    "images": Array [],
    "key": "Tess",
    "tag": "Character",
  },
}
`;

exports[`WML normalize positioned put method should successfully replace a parent with duplicate contents 1`] = `
Object {
  "If-0": Object {
    "appearances": Array [
      Object {
        "children": Array [],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "TestAsset",
            "tag": "Asset",
          },
          Object {
            "index": 0,
            "key": "testRoom",
            "tag": "Room",
          },
        ],
        "data": Object {
          "conditions": Array [
            Object {
              "dependencies": Array [
                "testVar",
              ],
              "if": "testVar",
            },
          ],
          "contents": Array [],
          "tag": "If",
        },
      },
      Object {
        "children": Array [
          Object {
            "children": Array [],
            "data": Object {
              "index": 0,
              "key": "testRoom#targetTwo",
              "tag": "Exit",
            },
          },
        ],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "TestAsset",
            "tag": "Asset",
          },
          Object {
            "index": 0,
            "key": "testRoom",
            "tag": "Room",
          },
        ],
        "data": Object {
          "conditions": Array [
            Object {
              "dependencies": Array [
                "testVar",
              ],
              "if": "testVar",
            },
          ],
          "contents": Array [],
          "tag": "If",
        },
      },
      Object {
        "children": Array [
          Object {
            "children": Array [],
            "data": Object {
              "index": 0,
              "key": "testRoom#targetThree",
              "tag": "Exit",
            },
          },
        ],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "TestAsset",
            "tag": "Asset",
          },
          Object {
            "index": 0,
            "key": "testRoom",
            "tag": "Room",
          },
        ],
        "data": Object {
          "conditions": Array [
            Object {
              "dependencies": Array [
                "testVar",
              ],
              "if": "testVar",
            },
          ],
          "contents": Array [],
          "tag": "If",
        },
      },
    ],
    "conditions": Array [
      Object {
        "dependencies": Array [
          "testVar",
        ],
        "if": "testVar",
      },
    ],
    "key": "If-0",
    "tag": "If",
  },
  "TestAsset": Object {
    "Story": false,
    "appearances": Array [
      Object {
        "children": Array [
          Object {
            "children": Array [],
            "data": Object {
              "index": 0,
              "key": "testVar",
              "tag": "Variable",
            },
          },
          Object {
            "children": Array [],
            "data": Object {
              "index": 0,
              "key": "testRoom",
              "tag": "Room",
            },
          },
          Object {
            "children": Array [],
            "data": Object {
              "index": 0,
              "key": "targetOne",
              "tag": "Room",
            },
          },
          Object {
            "children": Array [],
            "data": Object {
              "index": 0,
              "key": "targetTwo",
              "tag": "Room",
            },
          },
          Object {
            "children": Array [],
            "data": Object {
              "index": 0,
              "key": "targetThree",
              "tag": "Room",
            },
          },
        ],
        "contextStack": Array [],
        "data": Object {
          "Story": undefined,
          "contents": Array [],
          "key": "TestAsset",
          "tag": "Asset",
        },
      },
    ],
    "fileName": undefined,
    "instance": false,
    "key": "TestAsset",
    "tag": "Asset",
    "zone": undefined,
  },
  "targetOne": Object {
    "appearances": Array [
      Object {
        "children": Array [],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "TestAsset",
            "tag": "Asset",
          },
        ],
        "data": Object {
          "contents": Array [],
          "key": "targetOne",
          "name": Array [],
          "render": Array [],
          "tag": "Room",
          "x": undefined,
          "y": undefined,
        },
        "name": Array [],
        "render": Array [],
      },
    ],
    "key": "targetOne",
    "tag": "Room",
  },
  "targetThree": Object {
    "appearances": Array [
      Object {
        "children": Array [],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "TestAsset",
            "tag": "Asset",
          },
        ],
        "data": Object {
          "contents": Array [],
          "key": "targetThree",
          "name": Array [],
          "render": Array [],
          "tag": "Room",
          "x": undefined,
          "y": undefined,
        },
        "name": Array [],
        "render": Array [],
      },
    ],
    "key": "targetThree",
    "tag": "Room",
  },
  "targetTwo": Object {
    "appearances": Array [
      Object {
        "children": Array [],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "TestAsset",
            "tag": "Asset",
          },
        ],
        "data": Object {
          "contents": Array [],
          "key": "targetTwo",
          "name": Array [],
          "render": Array [],
          "tag": "Room",
          "x": undefined,
          "y": undefined,
        },
        "name": Array [],
        "render": Array [],
      },
    ],
    "key": "targetTwo",
    "tag": "Room",
  },
  "testRoom": Object {
    "appearances": Array [
      Object {
        "children": Array [
          Object {
            "children": Array [],
            "data": Object {
              "index": 0,
              "key": "If-0",
              "tag": "If",
            },
          },
          Object {
            "children": Array [],
            "data": Object {
              "index": 1,
              "key": "If-0",
              "tag": "If",
            },
          },
          Object {
            "children": Array [],
            "data": Object {
              "index": 2,
              "key": "If-0",
              "tag": "If",
            },
          },
        ],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "TestAsset",
            "tag": "Asset",
          },
        ],
        "data": Object {
          "contents": Array [],
          "key": "testRoom",
          "name": Array [],
          "render": Array [],
          "tag": "Room",
          "x": undefined,
          "y": undefined,
        },
        "name": Array [],
        "render": Array [],
      },
    ],
    "key": "testRoom",
    "tag": "Room",
  },
  "testRoom#targetThree": Object {
    "appearances": Array [
      Object {
        "children": Array [],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "TestAsset",
            "tag": "Asset",
          },
          Object {
            "index": 0,
            "key": "testRoom",
            "tag": "Room",
          },
          Object {
            "index": 2,
            "key": "If-0",
            "tag": "If",
          },
        ],
        "data": Object {
          "contents": Array [],
          "from": "testRoom",
          "key": "testRoom#targetThree",
          "name": "three",
          "tag": "Exit",
          "to": "targetThree",
        },
      },
    ],
    "from": "testRoom",
    "key": "testRoom#targetThree",
    "name": "three",
    "tag": "Exit",
    "to": "targetThree",
  },
  "testRoom#targetTwo": Object {
    "appearances": Array [
      Object {
        "children": Array [],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "TestAsset",
            "tag": "Asset",
          },
          Object {
            "index": 0,
            "key": "testRoom",
            "tag": "Room",
          },
          Object {
            "index": 1,
            "key": "If-0",
            "tag": "If",
          },
        ],
        "data": Object {
          "contents": Array [],
          "from": "testRoom",
          "key": "testRoom#targetTwo",
          "name": "two",
          "tag": "Exit",
          "to": "targetTwo",
        },
      },
    ],
    "from": "testRoom",
    "key": "testRoom#targetTwo",
    "name": "two",
    "tag": "Exit",
    "to": "targetTwo",
  },
  "testVar": Object {
    "appearances": Array [
      Object {
        "children": Array [],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "TestAsset",
            "tag": "Asset",
          },
        ],
        "data": Object {
          "default": "false",
          "key": "testVar",
          "tag": "Variable",
        },
      },
    ],
    "default": "false",
    "key": "testVar",
    "tag": "Variable",
  },
}
`;

exports[`WML normalize positioned put method should update an item in place 1`] = `
Object {
  "Test": Object {
    "Story": false,
    "appearances": Array [
      Object {
        "children": Array [
          Object {
            "children": Array [],
            "data": Object {
              "index": 0,
              "key": "test",
              "tag": "Room",
            },
          },
          Object {
            "children": Array [],
            "data": Object {
              "index": 1,
              "key": "test",
              "tag": "Room",
            },
          },
          Object {
            "children": Array [],
            "data": Object {
              "index": 2,
              "key": "test",
              "tag": "Room",
            },
          },
        ],
        "contextStack": Array [],
        "data": Object {
          "Story": undefined,
          "contents": Array [],
          "key": "Test",
          "tag": "Asset",
        },
      },
    ],
    "fileName": undefined,
    "instance": false,
    "key": "Test",
    "tag": "Asset",
    "zone": undefined,
  },
  "test": Object {
    "appearances": Array [
      Object {
        "children": Array [
          Object {
            "children": Array [
              Object {
                "children": Array [],
                "data": Object {
                  "tag": "String",
                  "value": "Uno",
                },
              },
            ],
            "data": Object {
              "contents": Array [],
              "tag": "Description",
            },
          },
        ],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "Test",
            "tag": "Asset",
          },
        ],
        "data": Object {
          "contents": Array [],
          "key": "test",
          "name": Array [],
          "render": Array [
            Object {
              "tag": "String",
              "value": "Uno",
            },
          ],
          "tag": "Room",
          "x": undefined,
          "y": undefined,
        },
        "name": Array [],
        "render": Array [
          Object {
            "tag": "String",
            "value": "Uno",
          },
        ],
      },
      Object {
        "children": Array [
          Object {
            "children": Array [
              Object {
                "children": Array [],
                "data": Object {
                  "tag": "String",
                  "value": "Dos",
                },
              },
            ],
            "data": Object {
              "contents": Array [],
              "tag": "Description",
            },
          },
        ],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "Test",
            "tag": "Asset",
          },
        ],
        "data": Object {
          "contents": Array [],
          "key": "test",
          "name": Array [],
          "render": Array [
            Object {
              "tag": "String",
              "value": "Dos",
            },
          ],
          "tag": "Room",
          "x": undefined,
          "y": undefined,
        },
        "name": Array [],
        "render": Array [
          Object {
            "tag": "String",
            "value": "Dos",
          },
        ],
      },
      Object {
        "children": Array [
          Object {
            "children": Array [
              Object {
                "children": Array [],
                "data": Object {
                  "tag": "String",
                  "value": "Tres",
                },
              },
            ],
            "data": Object {
              "contents": Array [],
              "tag": "Description",
            },
          },
        ],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "Test",
            "tag": "Asset",
          },
        ],
        "data": Object {
          "contents": Array [],
          "key": "test",
          "name": Array [],
          "render": Array [
            Object {
              "tag": "String",
              "value": "Tres",
            },
          ],
          "tag": "Room",
          "x": undefined,
          "y": undefined,
        },
        "name": Array [],
        "render": Array [
          Object {
            "tag": "String",
            "value": "Tres",
          },
        ],
      },
    ],
    "key": "test",
    "tag": "Room",
  },
}
`;

exports[`WML normalize put method should add an item in contents 1`] = `
Object {
  "TestAsset": Object {
    "Story": false,
    "appearances": Array [
      Object {
        "children": Array [
          Object {
            "children": Array [],
            "data": Object {
              "index": 0,
              "key": "test",
              "tag": "Room",
            },
          },
          Object {
            "children": Array [],
            "data": Object {
              "index": 1,
              "key": "test",
              "tag": "Room",
            },
          },
        ],
        "contextStack": Array [],
        "data": Object {
          "Story": undefined,
          "contents": Array [],
          "key": "TestAsset",
          "tag": "Asset",
        },
      },
    ],
    "fileName": undefined,
    "instance": false,
    "key": "TestAsset",
    "tag": "Asset",
    "zone": undefined,
  },
  "test": Object {
    "appearances": Array [
      Object {
        "children": Array [
          Object {
            "children": Array [
              Object {
                "children": Array [],
                "data": Object {
                  "tag": "String",
                  "value": "One",
                },
              },
            ],
            "data": Object {
              "contents": Array [],
              "tag": "Description",
            },
          },
        ],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "TestAsset",
            "tag": "Asset",
          },
        ],
        "data": Object {
          "contents": Array [],
          "key": "test",
          "name": Array [],
          "render": Array [
            Object {
              "tag": "String",
              "value": "One",
            },
          ],
          "tag": "Room",
          "x": undefined,
          "y": undefined,
        },
        "name": Array [],
        "render": Array [
          Object {
            "tag": "String",
            "value": "One",
          },
        ],
      },
      Object {
        "children": Array [
          Object {
            "children": Array [
              Object {
                "children": Array [],
                "data": Object {
                  "tag": "String",
                  "value": "Two",
                },
              },
            ],
            "data": Object {
              "contents": Array [],
              "tag": "Description",
            },
          },
        ],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "TestAsset",
            "tag": "Asset",
          },
        ],
        "data": Object {
          "contents": Array [],
          "key": "test",
          "name": Array [],
          "render": Array [
            Object {
              "tag": "String",
              "value": "Two",
            },
          ],
          "tag": "Room",
          "x": undefined,
          "y": undefined,
        },
        "name": Array [],
        "render": Array [
          Object {
            "tag": "String",
            "value": "Two",
          },
        ],
      },
    ],
    "key": "test",
    "tag": "Room",
  },
}
`;

exports[`WML normalize should accumulate multiple appearances of the same key 1`] = `
Object {
  "If-0": Object {
    "appearances": Array [
      Object {
        "children": Array [
          Object {
            "children": Array [],
            "data": Object {
              "index": 2,
              "key": "a123",
              "tag": "Room",
            },
          },
        ],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "Test",
            "tag": "Asset",
          },
        ],
        "data": Object {
          "conditions": Array [
            Object {
              "dependencies": Array [],
              "if": "true",
            },
          ],
          "contents": Array [],
          "tag": "If",
        },
      },
    ],
    "conditions": Array [
      Object {
        "dependencies": Array [],
        "if": "true",
      },
    ],
    "key": "If-0",
    "tag": "If",
  },
  "Test": Object {
    "Story": false,
    "appearances": Array [
      Object {
        "children": Array [
          Object {
            "children": Array [],
            "data": Object {
              "index": 0,
              "key": "a123",
              "tag": "Room",
            },
          },
          Object {
            "children": Array [],
            "data": Object {
              "index": 1,
              "key": "a123",
              "tag": "Room",
            },
          },
          Object {
            "children": Array [],
            "data": Object {
              "index": 0,
              "key": "If-0",
              "tag": "If",
            },
          },
        ],
        "contextStack": Array [],
        "data": Object {
          "Story": undefined,
          "contents": Array [],
          "key": "Test",
          "tag": "Asset",
        },
      },
    ],
    "fileName": undefined,
    "instance": false,
    "key": "Test",
    "tag": "Asset",
    "zone": undefined,
  },
  "a123": Object {
    "appearances": Array [
      Object {
        "children": Array [
          Object {
            "children": Array [
              Object {
                "children": Array [],
                "data": Object {
                  "tag": "String",
                  "value": "Vortex",
                },
              },
            ],
            "data": Object {
              "contents": Array [],
              "tag": "Name",
            },
          },
        ],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "Test",
            "tag": "Asset",
          },
        ],
        "data": Object {
          "contents": Array [],
          "key": "a123",
          "name": Array [
            Object {
              "tag": "String",
              "value": "Vortex",
            },
          ],
          "render": Array [],
          "tag": "Room",
          "x": undefined,
          "y": undefined,
        },
        "name": Array [
          Object {
            "tag": "String",
            "value": "Vortex",
          },
        ],
        "render": Array [],
      },
      Object {
        "children": Array [
          Object {
            "children": Array [
              Object {
                "children": Array [],
                "data": Object {
                  "tag": "String",
                  "value": "Hello, world!",
                },
              },
              Object {
                "children": Array [],
                "data": Object {
                  "tag": "Space",
                },
              },
            ],
            "data": Object {
              "contents": Array [],
              "tag": "Description",
            },
          },
        ],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "Test",
            "tag": "Asset",
          },
        ],
        "data": Object {
          "contents": Array [],
          "key": "a123",
          "name": Array [],
          "render": Array [
            Object {
              "tag": "String",
              "value": "Hello, world!",
            },
            Object {
              "tag": "Space",
            },
          ],
          "tag": "Room",
          "x": undefined,
          "y": undefined,
        },
        "name": Array [],
        "render": Array [
          Object {
            "tag": "String",
            "value": "Hello, world!",
          },
          Object {
            "tag": "Space",
          },
        ],
      },
      Object {
        "children": Array [
          Object {
            "children": Array [
              Object {
                "children": Array [],
                "data": Object {
                  "tag": "String",
                  "value": "Vortex!",
                },
              },
            ],
            "data": Object {
              "contents": Array [],
              "tag": "Description",
            },
          },
        ],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "Test",
            "tag": "Asset",
          },
          Object {
            "index": 0,
            "key": "If-0",
            "tag": "If",
          },
        ],
        "data": Object {
          "contents": Array [],
          "key": "a123",
          "name": Array [],
          "render": Array [
            Object {
              "tag": "String",
              "value": "Vortex!",
            },
          ],
          "tag": "Room",
          "x": undefined,
          "y": undefined,
        },
        "name": Array [],
        "render": Array [
          Object {
            "tag": "String",
            "value": "Vortex!",
          },
        ],
      },
    ],
    "key": "a123",
    "tag": "Room",
  },
}
`;

exports[`WML normalize should correctly handle conditionals in message text 1`] = `
Object {
  "Test": Object {
    "Story": false,
    "appearances": Array [
      Object {
        "children": Array [
          Object {
            "children": Array [],
            "data": Object {
              "index": 0,
              "key": "a123",
              "tag": "Room",
            },
          },
          Object {
            "children": Array [],
            "data": Object {
              "index": 0,
              "key": "strong",
              "tag": "Variable",
            },
          },
          Object {
            "children": Array [],
            "data": Object {
              "index": 0,
              "key": "trendy",
              "tag": "Variable",
            },
          },
        ],
        "contextStack": Array [],
        "data": Object {
          "Story": undefined,
          "contents": Array [],
          "key": "Test",
          "tag": "Asset",
        },
      },
    ],
    "fileName": undefined,
    "instance": false,
    "key": "Test",
    "tag": "Asset",
    "zone": undefined,
  },
  "a123": Object {
    "appearances": Array [
      Object {
        "children": Array [
          Object {
            "children": Array [
              Object {
                "children": Array [],
                "data": Object {
                  "tag": "String",
                  "value": "Vortex",
                },
              },
            ],
            "data": Object {
              "contents": Array [],
              "tag": "Name",
            },
          },
          Object {
            "children": Array [
              Object {
                "children": Array [],
                "data": Object {
                  "tag": "String",
                  "value": "Hello, world!",
                },
              },
              Object {
                "children": Array [
                  Object {
                    "children": Array [],
                    "data": Object {
                      "tag": "String",
                      "value": "Vortex!",
                    },
                  },
                ],
                "data": Object {
                  "conditions": Array [
                    Object {
                      "dependencies": Array [
                        "strong",
                      ],
                      "if": "strong",
                    },
                  ],
                  "contents": Array [],
                  "tag": "If",
                },
              },
              Object {
                "children": Array [],
                "data": Object {
                  "tag": "String",
                  "value": " ",
                },
              },
              Object {
                "children": Array [
                  Object {
                    "children": Array [
                      Object {
                        "children": Array [],
                        "data": Object {
                          "tag": "String",
                          "value": "V.O.R.T.E.X.",
                        },
                      },
                    ],
                    "data": Object {
                      "conditions": Array [
                        Object {
                          "dependencies": Array [
                            "trendy",
                          ],
                          "if": "trendy",
                        },
                      ],
                      "contents": Array [],
                      "tag": "If",
                    },
                  },
                ],
                "data": Object {
                  "conditions": Array [
                    Object {
                      "dependencies": Array [
                        "strong",
                      ],
                      "if": "!strong",
                    },
                  ],
                  "contents": Array [],
                  "tag": "If",
                },
              },
            ],
            "data": Object {
              "contents": Array [],
              "tag": "Description",
            },
          },
        ],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "Test",
            "tag": "Asset",
          },
        ],
        "data": Object {
          "contents": Array [],
          "key": "a123",
          "name": Array [
            Object {
              "tag": "String",
              "value": "Vortex",
            },
          ],
          "render": Array [
            Object {
              "tag": "String",
              "value": "Hello, world!",
            },
            Object {
              "conditions": Array [
                Object {
                  "dependencies": Array [
                    "strong",
                  ],
                  "if": "strong",
                },
              ],
              "contents": Array [
                Object {
                  "tag": "String",
                  "value": "Vortex!",
                },
              ],
              "tag": "If",
            },
            Object {
              "tag": "String",
              "value": " ",
            },
            Object {
              "conditions": Array [
                Object {
                  "dependencies": Array [
                    "strong",
                  ],
                  "if": "!strong",
                },
              ],
              "contents": Array [
                Object {
                  "conditions": Array [
                    Object {
                      "dependencies": Array [
                        "trendy",
                      ],
                      "if": "trendy",
                    },
                  ],
                  "contents": Array [
                    Object {
                      "tag": "String",
                      "value": "V.O.R.T.E.X.",
                    },
                  ],
                  "tag": "If",
                },
              ],
              "tag": "If",
            },
          ],
          "tag": "Room",
          "x": undefined,
          "y": undefined,
        },
        "name": Array [
          Object {
            "tag": "String",
            "value": "Vortex",
          },
        ],
        "render": Array [
          Object {
            "tag": "String",
            "value": "Hello, world!",
          },
          Object {
            "conditions": Array [
              Object {
                "dependencies": Array [
                  "strong",
                ],
                "if": "strong",
              },
            ],
            "contents": Array [
              Object {
                "tag": "String",
                "value": "Vortex!",
              },
            ],
            "tag": "Condition",
          },
          Object {
            "tag": "String",
            "value": " ",
          },
          Object {
            "conditions": Array [
              Object {
                "dependencies": Array [
                  "strong",
                ],
                "if": "!strong",
              },
            ],
            "contents": Array [
              Object {
                "conditions": Array [
                  Object {
                    "dependencies": Array [
                      "trendy",
                    ],
                    "if": "trendy",
                  },
                ],
                "contents": Array [
                  Object {
                    "tag": "String",
                    "value": "V.O.R.T.E.X.",
                  },
                ],
                "tag": "Condition",
              },
            ],
            "tag": "Condition",
          },
        ],
      },
    ],
    "key": "a123",
    "tag": "Room",
  },
  "strong": Object {
    "appearances": Array [
      Object {
        "children": Array [],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "Test",
            "tag": "Asset",
          },
        ],
        "data": Object {
          "default": "false",
          "key": "strong",
          "tag": "Variable",
        },
      },
    ],
    "default": "false",
    "key": "strong",
    "tag": "Variable",
  },
  "trendy": Object {
    "appearances": Array [
      Object {
        "children": Array [],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "Test",
            "tag": "Asset",
          },
        ],
        "data": Object {
          "default": "false",
          "key": "trendy",
          "tag": "Variable",
        },
      },
    ],
    "default": "false",
    "key": "trendy",
    "tag": "Variable",
  },
}
`;

exports[`WML normalize should correctly handle multiple and nested conditionals 1`] = `
Object {
  "If-1": Object {
    "appearances": Array [
      Object {
        "children": Array [
          Object {
            "children": Array [],
            "data": Object {
              "index": 1,
              "key": "a123",
              "tag": "Room",
            },
          },
        ],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "Test",
            "tag": "Asset",
          },
        ],
        "data": Object {
          "conditions": Array [
            Object {
              "dependencies": Array [
                "strong",
              ],
              "if": "strong",
            },
          ],
          "contents": Array [],
          "tag": "If",
        },
      },
    ],
    "conditions": Array [
      Object {
        "dependencies": Array [
          "strong",
        ],
        "if": "strong",
      },
    ],
    "key": "If-1",
    "tag": "If",
  },
  "If-2": Object {
    "appearances": Array [
      Object {
        "children": Array [
          Object {
            "children": Array [],
            "data": Object {
              "index": 0,
              "key": "If-3",
              "tag": "If",
            },
          },
        ],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "Test",
            "tag": "Asset",
          },
        ],
        "data": Object {
          "conditions": Array [
            Object {
              "dependencies": Array [
                "strong",
              ],
              "if": "!strong",
            },
          ],
          "contents": Array [],
          "tag": "If",
        },
      },
    ],
    "conditions": Array [
      Object {
        "dependencies": Array [
          "strong",
        ],
        "if": "!strong",
      },
    ],
    "key": "If-2",
    "tag": "If",
  },
  "If-3": Object {
    "appearances": Array [
      Object {
        "children": Array [
          Object {
            "children": Array [],
            "data": Object {
              "index": 2,
              "key": "a123",
              "tag": "Room",
            },
          },
        ],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "Test",
            "tag": "Asset",
          },
          Object {
            "index": 0,
            "key": "If-2",
            "tag": "If",
          },
        ],
        "data": Object {
          "conditions": Array [
            Object {
              "dependencies": Array [
                "trendy",
              ],
              "if": "trendy",
            },
          ],
          "contents": Array [],
          "tag": "If",
        },
      },
    ],
    "conditions": Array [
      Object {
        "dependencies": Array [
          "trendy",
        ],
        "if": "trendy",
      },
    ],
    "key": "If-3",
    "tag": "If",
  },
  "Test": Object {
    "Story": false,
    "appearances": Array [
      Object {
        "children": Array [
          Object {
            "children": Array [],
            "data": Object {
              "index": 0,
              "key": "a123",
              "tag": "Room",
            },
          },
          Object {
            "children": Array [],
            "data": Object {
              "index": 0,
              "key": "If-1",
              "tag": "If",
            },
          },
          Object {
            "children": Array [],
            "data": Object {
              "index": 0,
              "key": "If-2",
              "tag": "If",
            },
          },
          Object {
            "children": Array [],
            "data": Object {
              "index": 0,
              "key": "strong",
              "tag": "Variable",
            },
          },
          Object {
            "children": Array [],
            "data": Object {
              "index": 0,
              "key": "trendy",
              "tag": "Variable",
            },
          },
        ],
        "contextStack": Array [],
        "data": Object {
          "Story": undefined,
          "contents": Array [],
          "key": "Test",
          "tag": "Asset",
        },
      },
    ],
    "fileName": undefined,
    "instance": false,
    "key": "Test",
    "tag": "Asset",
    "zone": undefined,
  },
  "a123": Object {
    "appearances": Array [
      Object {
        "children": Array [
          Object {
            "children": Array [
              Object {
                "children": Array [],
                "data": Object {
                  "tag": "String",
                  "value": "Vortex",
                },
              },
            ],
            "data": Object {
              "contents": Array [],
              "tag": "Name",
            },
          },
          Object {
            "children": Array [
              Object {
                "children": Array [],
                "data": Object {
                  "tag": "String",
                  "value": "Hello, world!",
                },
              },
            ],
            "data": Object {
              "contents": Array [],
              "tag": "Description",
            },
          },
        ],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "Test",
            "tag": "Asset",
          },
        ],
        "data": Object {
          "contents": Array [],
          "key": "a123",
          "name": Array [
            Object {
              "tag": "String",
              "value": "Vortex",
            },
          ],
          "render": Array [
            Object {
              "tag": "String",
              "value": "Hello, world!",
            },
          ],
          "tag": "Room",
          "x": undefined,
          "y": undefined,
        },
        "name": Array [
          Object {
            "tag": "String",
            "value": "Vortex",
          },
        ],
        "render": Array [
          Object {
            "tag": "String",
            "value": "Hello, world!",
          },
        ],
      },
      Object {
        "children": Array [
          Object {
            "children": Array [
              Object {
                "children": Array [],
                "data": Object {
                  "tag": "String",
                  "value": "Vortex!",
                },
              },
            ],
            "data": Object {
              "contents": Array [],
              "tag": "Description",
            },
          },
        ],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "Test",
            "tag": "Asset",
          },
          Object {
            "index": 0,
            "key": "If-1",
            "tag": "If",
          },
        ],
        "data": Object {
          "contents": Array [],
          "key": "a123",
          "name": Array [],
          "render": Array [
            Object {
              "tag": "String",
              "value": "Vortex!",
            },
          ],
          "tag": "Room",
          "x": undefined,
          "y": undefined,
        },
        "name": Array [],
        "render": Array [
          Object {
            "tag": "String",
            "value": "Vortex!",
          },
        ],
      },
      Object {
        "children": Array [
          Object {
            "children": Array [
              Object {
                "children": Array [],
                "data": Object {
                  "tag": "String",
                  "value": "V.O.R.T.E.X.",
                },
              },
            ],
            "data": Object {
              "contents": Array [],
              "tag": "Description",
            },
          },
        ],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "Test",
            "tag": "Asset",
          },
          Object {
            "index": 0,
            "key": "If-2",
            "tag": "If",
          },
          Object {
            "index": 0,
            "key": "If-3",
            "tag": "If",
          },
        ],
        "data": Object {
          "contents": Array [],
          "key": "a123",
          "name": Array [],
          "render": Array [
            Object {
              "tag": "String",
              "value": "V.O.R.T.E.X.",
            },
          ],
          "tag": "Room",
          "x": undefined,
          "y": undefined,
        },
        "name": Array [],
        "render": Array [
          Object {
            "tag": "String",
            "value": "V.O.R.T.E.X.",
          },
        ],
      },
    ],
    "key": "a123",
    "tag": "Room",
  },
  "strong": Object {
    "appearances": Array [
      Object {
        "children": Array [],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "Test",
            "tag": "Asset",
          },
        ],
        "data": Object {
          "default": "false",
          "key": "strong",
          "tag": "Variable",
        },
      },
    ],
    "default": "false",
    "key": "strong",
    "tag": "Variable",
  },
  "trendy": Object {
    "appearances": Array [
      Object {
        "children": Array [],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "Test",
            "tag": "Asset",
          },
        ],
        "data": Object {
          "default": "false",
          "key": "trendy",
          "tag": "Variable",
        },
      },
    ],
    "default": "false",
    "key": "trendy",
    "tag": "Variable",
  },
}
`;

exports[`WML normalize should correctly serialize multiple unconditioned descriptions 1`] = `
Object {
  "Test": Object {
    "Story": false,
    "appearances": Array [
      Object {
        "children": Array [
          Object {
            "children": Array [],
            "data": Object {
              "index": 0,
              "key": "test",
              "tag": "Room",
            },
          },
          Object {
            "children": Array [],
            "data": Object {
              "index": 1,
              "key": "test",
              "tag": "Room",
            },
          },
        ],
        "contextStack": Array [],
        "data": Object {
          "Story": undefined,
          "contents": Array [],
          "key": "Test",
          "tag": "Asset",
        },
      },
    ],
    "fileName": undefined,
    "instance": false,
    "key": "Test",
    "tag": "Asset",
    "zone": undefined,
  },
  "test": Object {
    "appearances": Array [
      Object {
        "children": Array [
          Object {
            "children": Array [
              Object {
                "children": Array [],
                "data": Object {
                  "tag": "String",
                  "value": "One",
                },
              },
            ],
            "data": Object {
              "contents": Array [],
              "tag": "Description",
            },
          },
        ],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "Test",
            "tag": "Asset",
          },
        ],
        "data": Object {
          "contents": Array [],
          "key": "test",
          "name": Array [],
          "render": Array [
            Object {
              "tag": "String",
              "value": "One",
            },
          ],
          "tag": "Room",
          "x": undefined,
          "y": undefined,
        },
        "name": Array [],
        "render": Array [
          Object {
            "tag": "String",
            "value": "One",
          },
        ],
      },
      Object {
        "children": Array [
          Object {
            "children": Array [
              Object {
                "children": Array [],
                "data": Object {
                  "tag": "String",
                  "value": "Two",
                },
              },
            ],
            "data": Object {
              "contents": Array [],
              "tag": "Description",
            },
          },
        ],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "Test",
            "tag": "Asset",
          },
        ],
        "data": Object {
          "contents": Array [],
          "key": "test",
          "name": Array [],
          "render": Array [
            Object {
              "tag": "String",
              "value": "Two",
            },
          ],
          "tag": "Room",
          "x": undefined,
          "y": undefined,
        },
        "name": Array [],
        "render": Array [
          Object {
            "tag": "String",
            "value": "Two",
          },
        ],
      },
    ],
    "key": "test",
    "tag": "Room",
  },
}
`;

exports[`WML normalize should denormalize condition dependencies into contextStack 1`] = `
Object {
  "If-1": Object {
    "appearances": Array [
      Object {
        "children": Array [
          Object {
            "children": Array [],
            "data": Object {
              "index": 1,
              "key": "a123",
              "tag": "Room",
            },
          },
        ],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "Test",
            "tag": "Asset",
          },
        ],
        "data": Object {
          "conditions": Array [
            Object {
              "dependencies": Array [
                "strong",
              ],
              "if": "strong",
            },
          ],
          "contents": Array [],
          "tag": "If",
        },
      },
    ],
    "conditions": Array [
      Object {
        "dependencies": Array [
          "strong",
        ],
        "if": "strong",
      },
    ],
    "key": "If-1",
    "tag": "If",
  },
  "Test": Object {
    "Story": false,
    "appearances": Array [
      Object {
        "children": Array [
          Object {
            "children": Array [],
            "data": Object {
              "index": 0,
              "key": "a123",
              "tag": "Room",
            },
          },
          Object {
            "children": Array [],
            "data": Object {
              "index": 0,
              "key": "If-1",
              "tag": "If",
            },
          },
          Object {
            "children": Array [],
            "data": Object {
              "index": 0,
              "key": "strong",
              "tag": "Variable",
            },
          },
        ],
        "contextStack": Array [],
        "data": Object {
          "Story": undefined,
          "contents": Array [],
          "key": "Test",
          "tag": "Asset",
        },
      },
    ],
    "fileName": undefined,
    "instance": false,
    "key": "Test",
    "tag": "Asset",
    "zone": undefined,
  },
  "a123": Object {
    "appearances": Array [
      Object {
        "children": Array [
          Object {
            "children": Array [
              Object {
                "children": Array [],
                "data": Object {
                  "tag": "String",
                  "value": "Vortex",
                },
              },
            ],
            "data": Object {
              "contents": Array [],
              "tag": "Name",
            },
          },
          Object {
            "children": Array [
              Object {
                "children": Array [],
                "data": Object {
                  "tag": "String",
                  "value": "Hello, world!",
                },
              },
            ],
            "data": Object {
              "contents": Array [],
              "tag": "Description",
            },
          },
        ],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "Test",
            "tag": "Asset",
          },
        ],
        "data": Object {
          "contents": Array [],
          "key": "a123",
          "name": Array [
            Object {
              "tag": "String",
              "value": "Vortex",
            },
          ],
          "render": Array [
            Object {
              "tag": "String",
              "value": "Hello, world!",
            },
          ],
          "tag": "Room",
          "x": undefined,
          "y": undefined,
        },
        "name": Array [
          Object {
            "tag": "String",
            "value": "Vortex",
          },
        ],
        "render": Array [
          Object {
            "tag": "String",
            "value": "Hello, world!",
          },
        ],
      },
      Object {
        "children": Array [
          Object {
            "children": Array [
              Object {
                "children": Array [],
                "data": Object {
                  "tag": "String",
                  "value": "Vortex!",
                },
              },
            ],
            "data": Object {
              "contents": Array [],
              "tag": "Description",
            },
          },
        ],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "Test",
            "tag": "Asset",
          },
          Object {
            "index": 0,
            "key": "If-1",
            "tag": "If",
          },
        ],
        "data": Object {
          "contents": Array [],
          "key": "a123",
          "name": Array [],
          "render": Array [
            Object {
              "tag": "String",
              "value": "Vortex!",
            },
          ],
          "tag": "Room",
          "x": undefined,
          "y": undefined,
        },
        "name": Array [],
        "render": Array [
          Object {
            "tag": "String",
            "value": "Vortex!",
          },
        ],
      },
    ],
    "key": "a123",
    "tag": "Room",
  },
  "strong": Object {
    "appearances": Array [
      Object {
        "children": Array [],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "Test",
            "tag": "Asset",
          },
        ],
        "data": Object {
          "default": "false",
          "key": "strong",
          "tag": "Variable",
        },
      },
    ],
    "default": "false",
    "key": "strong",
    "tag": "Variable",
  },
}
`;

exports[`WML normalize should normalize a character 1`] = `
Object {
  "Import-0": Object {
    "appearances": Array [
      Object {
        "children": Array [],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "Tess",
            "tag": "Character",
          },
        ],
        "data": Object {
          "from": "base",
          "mapping": Object {},
          "tag": "Import",
        },
      },
    ],
    "from": "base",
    "key": "Import-0",
    "mapping": Object {},
    "tag": "Import",
  },
  "Tess": Object {
    "FirstImpression": "Frumpy goth",
    "Name": "Tess",
    "OneCoolThing": "Fuchsia eyes",
    "Outfit": "A battered frock-coat",
    "Pronouns": Object {
      "adjective": "hers",
      "object": "her",
      "possessive": "her",
      "reflexive": "herself",
      "subject": "she",
    },
    "appearances": Array [
      Object {
        "children": Array [
          Object {
            "children": Array [],
            "data": Object {
              "index": 0,
              "key": "Import-0",
              "tag": "Import",
            },
          },
        ],
        "contextStack": Array [],
        "data": Object {
          "FirstImpression": "Frumpy goth",
          "Name": "Tess",
          "OneCoolThing": "Fuchsia eyes",
          "Outfit": "A battered frock-coat",
          "Pronouns": Object {
            "adjective": "hers",
            "object": "her",
            "possessive": "her",
            "reflexive": "herself",
            "subject": "she",
          },
          "contents": Array [],
          "key": "Tess",
          "tag": "Character",
        },
      },
    ],
    "assets": Array [],
    "fileName": undefined,
    "images": Array [],
    "key": "Tess",
    "tag": "Character",
  },
}
`;

exports[`WML normalize should normalize all types of links 1`] = `
Object {
  "Test": Object {
    "Story": false,
    "appearances": Array [
      Object {
        "children": Array [
          Object {
            "children": Array [],
            "data": Object {
              "index": 0,
              "key": "clockTower",
              "tag": "Feature",
            },
          },
          Object {
            "children": Array [],
            "data": Object {
              "index": 0,
              "key": "town",
              "tag": "Knowledge",
            },
          },
          Object {
            "children": Array [],
            "data": Object {
              "index": 0,
              "key": "active",
              "tag": "Variable",
            },
          },
          Object {
            "children": Array [],
            "data": Object {
              "index": 0,
              "key": "toggleActive",
              "tag": "Action",
            },
          },
        ],
        "contextStack": Array [],
        "data": Object {
          "Story": undefined,
          "contents": Array [],
          "key": "Test",
          "tag": "Asset",
        },
      },
    ],
    "fileName": undefined,
    "instance": false,
    "key": "Test",
    "tag": "Asset",
    "zone": undefined,
  },
  "active": Object {
    "appearances": Array [
      Object {
        "children": Array [],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "Test",
            "tag": "Asset",
          },
        ],
        "data": Object {
          "default": "true",
          "key": "active",
          "tag": "Variable",
        },
      },
    ],
    "default": "true",
    "key": "active",
    "tag": "Variable",
  },
  "clockTower": Object {
    "appearances": Array [
      Object {
        "children": Array [
          Object {
            "children": Array [
              Object {
                "children": Array [],
                "data": Object {
                  "tag": "String",
                  "value": "Clock Tower",
                },
              },
            ],
            "data": Object {
              "contents": Array [],
              "tag": "Name",
            },
          },
          Object {
            "children": Array [
              Object {
                "children": Array [],
                "data": Object {
                  "tag": "Link",
                  "text": "Waverly",
                  "to": "town",
                },
              },
              Object {
                "children": Array [],
                "data": Object {
                  "tag": "String",
                  "value": " ",
                },
              },
              Object {
                "children": Array [],
                "data": Object {
                  "tag": "Link",
                  "text": "Clock",
                  "to": "clockTower",
                },
              },
              Object {
                "children": Array [],
                "data": Object {
                  "tag": "String",
                  "value": " ",
                },
              },
              Object {
                "children": Array [],
                "data": Object {
                  "tag": "Link",
                  "text": "Toggle",
                  "to": "toggleActive",
                },
              },
            ],
            "data": Object {
              "contents": Array [],
              "tag": "Description",
            },
          },
        ],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "Test",
            "tag": "Asset",
          },
        ],
        "data": Object {
          "contents": Array [],
          "key": "clockTower",
          "name": Array [
            Object {
              "tag": "String",
              "value": "Clock Tower",
            },
          ],
          "render": Array [
            Object {
              "tag": "Link",
              "text": "Waverly",
              "to": "town",
            },
            Object {
              "tag": "String",
              "value": " ",
            },
            Object {
              "tag": "Link",
              "text": "Clock",
              "to": "clockTower",
            },
            Object {
              "tag": "String",
              "value": " ",
            },
            Object {
              "tag": "Link",
              "text": "Toggle",
              "to": "toggleActive",
            },
          ],
          "tag": "Feature",
        },
        "name": Array [
          Object {
            "tag": "String",
            "value": "Clock Tower",
          },
        ],
        "render": Array [
          Object {
            "tag": "Link",
            "targetTag": "Knowledge",
            "text": "Waverly",
            "to": "town",
          },
          Object {
            "tag": "String",
            "value": " ",
          },
          Object {
            "tag": "Link",
            "targetTag": "Feature",
            "text": "Clock",
            "to": "clockTower",
          },
          Object {
            "tag": "String",
            "value": " ",
          },
          Object {
            "tag": "Link",
            "targetTag": "Action",
            "text": "Toggle",
            "to": "toggleActive",
          },
        ],
      },
    ],
    "key": "clockTower",
    "tag": "Feature",
  },
  "toggleActive": Object {
    "appearances": Array [
      Object {
        "children": Array [],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "Test",
            "tag": "Asset",
          },
        ],
        "data": Object {
          "key": "toggleActive",
          "src": "active = !active",
          "tag": "Action",
        },
      },
    ],
    "key": "toggleActive",
    "src": "active = !active",
    "tag": "Action",
  },
  "town": Object {
    "appearances": Array [
      Object {
        "children": Array [
          Object {
            "children": Array [
              Object {
                "children": Array [],
                "data": Object {
                  "tag": "String",
                  "value": "Waverly",
                },
              },
            ],
            "data": Object {
              "contents": Array [],
              "tag": "Name",
            },
          },
          Object {
            "children": Array [
              Object {
                "children": Array [],
                "data": Object {
                  "tag": "String",
                  "value": "The town of Waverly is a pleasant place to live.",
                },
              },
            ],
            "data": Object {
              "contents": Array [],
              "tag": "Description",
            },
          },
        ],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "Test",
            "tag": "Asset",
          },
        ],
        "data": Object {
          "contents": Array [],
          "key": "town",
          "name": Array [
            Object {
              "tag": "String",
              "value": "Waverly",
            },
          ],
          "render": Array [
            Object {
              "tag": "String",
              "value": "The town of Waverly is a pleasant place to live.",
            },
          ],
          "tag": "Knowledge",
        },
        "name": Array [
          Object {
            "tag": "String",
            "value": "Waverly",
          },
        ],
        "render": Array [
          Object {
            "tag": "String",
            "value": "The town of Waverly is a pleasant place to live.",
          },
        ],
      },
    ],
    "key": "town",
    "tag": "Knowledge",
  },
}
`;

exports[`WML normalize should normalize every needed tag 1`] = `
Object {
  "ImageTest": Object {
    "appearances": Array [
      Object {
        "children": Array [],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "Test",
            "tag": "Asset",
          },
          Object {
            "index": 0,
            "key": "TestMap",
            "tag": "Map",
          },
        ],
        "data": Object {
          "key": "ImageTest",
          "tag": "Image",
        },
      },
    ],
    "key": "ImageTest",
    "tag": "Image",
  },
  "Import-0": Object {
    "appearances": Array [
      Object {
        "children": Array [
          Object {
            "children": Array [],
            "data": Object {
              "index": 0,
              "key": "power",
              "tag": "Variable",
            },
          },
          Object {
            "children": Array [],
            "data": Object {
              "index": 0,
              "key": "overview",
              "tag": "Room",
            },
          },
          Object {
            "children": Array [],
            "data": Object {
              "index": 0,
              "key": "baseInfo",
              "tag": "Knowledge",
            },
          },
        ],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "Test",
            "tag": "Asset",
          },
        ],
        "data": Object {
          "from": "BASE",
          "mapping": Object {
            "baseInfo": Object {
              "key": "baseInfo",
              "type": "Knowledge",
            },
            "overview": Object {
              "key": "overview",
              "type": "Room",
            },
            "power": Object {
              "key": "basePower",
              "type": "Variable",
            },
          },
          "tag": "Import",
        },
      },
    ],
    "from": "BASE",
    "key": "Import-0",
    "mapping": Object {
      "baseInfo": Object {
        "key": "baseInfo",
        "type": "Knowledge",
      },
      "overview": Object {
        "key": "overview",
        "type": "Room",
      },
      "power": Object {
        "key": "basePower",
        "type": "Variable",
      },
    },
    "tag": "Import",
  },
  "Test": Object {
    "Story": false,
    "appearances": Array [
      Object {
        "children": Array [
          Object {
            "children": Array [],
            "data": Object {
              "index": 0,
              "key": "Import-0",
              "tag": "Import",
            },
          },
          Object {
            "children": Array [],
            "data": Object {
              "index": 0,
              "key": "a123",
              "tag": "Room",
            },
          },
          Object {
            "children": Array [],
            "data": Object {
              "index": 0,
              "key": "b456",
              "tag": "Room",
            },
          },
          Object {
            "children": Array [],
            "data": Object {
              "index": 0,
              "key": "TestMap",
              "tag": "Map",
            },
          },
          Object {
            "children": Array [],
            "data": Object {
              "index": 1,
              "key": "clockTower",
              "tag": "Feature",
            },
          },
          Object {
            "children": Array [],
            "data": Object {
              "index": 0,
              "key": "town",
              "tag": "Knowledge",
            },
          },
          Object {
            "children": Array [],
            "data": Object {
              "index": 0,
              "key": "active",
              "tag": "Variable",
            },
          },
          Object {
            "children": Array [],
            "data": Object {
              "index": 0,
              "key": "inactive",
              "tag": "Computed",
            },
          },
          Object {
            "children": Array [],
            "data": Object {
              "index": 0,
              "key": "toggleActive",
              "tag": "Action",
            },
          },
          Object {
            "children": Array [],
            "data": Object {
              "index": 0,
              "key": "postFix",
              "tag": "Bookmark",
            },
          },
          Object {
            "children": Array [],
            "data": Object {
              "index": 0,
              "key": "activateMoment",
              "tag": "Moment",
            },
          },
        ],
        "contextStack": Array [],
        "data": Object {
          "Story": undefined,
          "contents": Array [],
          "key": "Test",
          "tag": "Asset",
        },
      },
    ],
    "fileName": undefined,
    "instance": false,
    "key": "Test",
    "tag": "Asset",
    "zone": undefined,
  },
  "TestMap": Object {
    "appearances": Array [
      Object {
        "children": Array [
          Object {
            "children": Array [],
            "data": Object {
              "index": 0,
              "key": "ImageTest",
              "tag": "Image",
            },
          },
          Object {
            "children": Array [],
            "data": Object {
              "index": 1,
              "key": "a123",
              "tag": "Room",
            },
          },
        ],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "Test",
            "tag": "Asset",
          },
        ],
        "data": Object {
          "contents": Array [],
          "images": Array [
            "ImageTest",
          ],
          "key": "TestMap",
          "name": Array [
            Object {
              "tag": "String",
              "value": "Test Map",
            },
          ],
          "rooms": Array [
            Object {
              "conditions": Array [],
              "key": "a123",
              "x": 200,
              "y": 150,
            },
          ],
          "tag": "Map",
        },
        "images": Array [
          "ImageTest",
        ],
        "name": Array [
          Object {
            "tag": "String",
            "value": "Test Map",
          },
        ],
        "rooms": Array [
          Object {
            "conditions": Array [],
            "key": "a123",
            "x": 200,
            "y": 150,
          },
        ],
      },
    ],
    "key": "TestMap",
    "tag": "Map",
  },
  "a123": Object {
    "appearances": Array [
      Object {
        "children": Array [
          Object {
            "children": Array [],
            "data": Object {
              "index": 0,
              "key": "a123#b456",
              "tag": "Exit",
            },
          },
          Object {
            "children": Array [],
            "data": Object {
              "index": 0,
              "key": "clockTower",
              "tag": "Feature",
            },
          },
        ],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "Test",
            "tag": "Asset",
          },
        ],
        "data": Object {
          "contents": Array [],
          "key": "a123",
          "name": Array [],
          "render": Array [],
          "tag": "Room",
          "x": undefined,
          "y": undefined,
        },
        "name": Array [],
        "render": Array [],
      },
      Object {
        "children": Array [],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "Test",
            "tag": "Asset",
          },
          Object {
            "index": 0,
            "key": "TestMap",
            "tag": "Map",
          },
        ],
        "data": Object {
          "contents": Array [],
          "key": "a123",
          "name": Array [],
          "render": Array [],
          "tag": "Room",
          "x": 200,
          "y": 150,
        },
        "name": Array [],
        "render": Array [],
        "x": 200,
        "y": 150,
      },
      Object {
        "children": Array [],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "Test",
            "tag": "Asset",
          },
          Object {
            "index": 0,
            "key": "activateMoment",
            "tag": "Moment",
          },
          Object {
            "index": 0,
            "key": "activate",
            "tag": "Message",
          },
        ],
        "data": Object {
          "contents": Array [],
          "key": "a123",
          "name": Array [],
          "render": Array [],
          "tag": "Room",
          "x": undefined,
          "y": undefined,
        },
        "name": Array [],
        "render": Array [],
      },
    ],
    "key": "a123",
    "tag": "Room",
  },
  "a123#b456": Object {
    "appearances": Array [
      Object {
        "children": Array [],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "Test",
            "tag": "Asset",
          },
          Object {
            "index": 0,
            "key": "a123",
            "tag": "Room",
          },
        ],
        "data": Object {
          "contents": Array [],
          "from": "a123",
          "key": "a123#b456",
          "name": "",
          "tag": "Exit",
          "to": "b456",
        },
      },
    ],
    "from": "a123",
    "key": "a123#b456",
    "name": "",
    "tag": "Exit",
    "to": "b456",
  },
  "activate": Object {
    "appearances": Array [
      Object {
        "children": Array [
          Object {
            "children": Array [],
            "data": Object {
              "tag": "String",
              "value": "It activates!",
            },
          },
          Object {
            "children": Array [],
            "data": Object {
              "index": 2,
              "key": "a123",
              "tag": "Room",
            },
          },
        ],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "Test",
            "tag": "Asset",
          },
          Object {
            "index": 0,
            "key": "activateMoment",
            "tag": "Moment",
          },
        ],
        "data": Object {
          "contents": Array [],
          "key": "activate",
          "render": Array [
            Object {
              "tag": "String",
              "value": "It activates!",
            },
          ],
          "rooms": Array [
            Object {
              "key": "a123",
            },
          ],
          "tag": "Message",
        },
        "render": Array [
          Object {
            "tag": "String",
            "value": "It activates!",
          },
        ],
        "rooms": Array [
          Object {
            "key": "a123",
          },
        ],
      },
    ],
    "key": "activate",
    "tag": "Message",
  },
  "activateMoment": Object {
    "appearances": Array [
      Object {
        "children": Array [
          Object {
            "children": Array [],
            "data": Object {
              "index": 0,
              "key": "activate",
              "tag": "Message",
            },
          },
        ],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "Test",
            "tag": "Asset",
          },
        ],
        "data": Object {
          "contents": Array [],
          "key": "activateMoment",
          "tag": "Moment",
        },
        "messages": Array [],
      },
    ],
    "key": "activateMoment",
    "tag": "Moment",
  },
  "active": Object {
    "appearances": Array [
      Object {
        "children": Array [],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "Test",
            "tag": "Asset",
          },
        ],
        "data": Object {
          "default": "true",
          "key": "active",
          "tag": "Variable",
        },
      },
    ],
    "default": "true",
    "key": "active",
    "tag": "Variable",
  },
  "b456": Object {
    "appearances": Array [
      Object {
        "children": Array [],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "Test",
            "tag": "Asset",
          },
        ],
        "data": Object {
          "contents": Array [],
          "key": "b456",
          "name": Array [],
          "render": Array [],
          "tag": "Room",
          "x": undefined,
          "y": undefined,
        },
        "name": Array [],
        "render": Array [],
      },
    ],
    "key": "b456",
    "tag": "Room",
  },
  "baseInfo": Object {
    "appearances": Array [
      Object {
        "children": Array [],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "Test",
            "tag": "Asset",
          },
          Object {
            "index": 0,
            "key": "Import-0",
            "tag": "Import",
          },
        ],
        "data": Object {
          "contents": Array [],
          "from": "baseInfo",
          "key": "baseInfo",
          "name": Array [],
          "render": Array [],
          "tag": "Knowledge",
        },
        "name": Array [],
        "render": Array [],
      },
    ],
    "key": "baseInfo",
    "tag": "Knowledge",
  },
  "clockTower": Object {
    "appearances": Array [
      Object {
        "children": Array [],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "Test",
            "tag": "Asset",
          },
          Object {
            "index": 0,
            "key": "a123",
            "tag": "Room",
          },
        ],
        "data": Object {
          "contents": Array [],
          "key": "clockTower",
          "name": Array [],
          "render": Array [],
          "tag": "Feature",
        },
        "name": Array [],
        "render": Array [],
      },
      Object {
        "children": Array [
          Object {
            "children": Array [
              Object {
                "children": Array [],
                "data": Object {
                  "tag": "String",
                  "value": "Clock Tower",
                },
              },
            ],
            "data": Object {
              "contents": Array [],
              "tag": "Name",
            },
          },
        ],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "Test",
            "tag": "Asset",
          },
        ],
        "data": Object {
          "contents": Array [],
          "key": "clockTower",
          "name": Array [
            Object {
              "tag": "String",
              "value": "Clock Tower",
            },
          ],
          "render": Array [],
          "tag": "Feature",
        },
        "name": Array [
          Object {
            "tag": "String",
            "value": "Clock Tower",
          },
        ],
        "render": Array [],
      },
    ],
    "key": "clockTower",
    "tag": "Feature",
  },
  "inactive": Object {
    "appearances": Array [
      Object {
        "children": Array [],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "Test",
            "tag": "Asset",
          },
        ],
        "data": Object {
          "dependencies": Array [
            "active",
          ],
          "key": "inactive",
          "src": "!active",
          "tag": "Computed",
        },
      },
    ],
    "dependencies": Array [
      "active",
    ],
    "key": "inactive",
    "src": "!active",
    "tag": "Computed",
  },
  "overview": Object {
    "appearances": Array [
      Object {
        "children": Array [],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "Test",
            "tag": "Asset",
          },
          Object {
            "index": 0,
            "key": "Import-0",
            "tag": "Import",
          },
        ],
        "data": Object {
          "contents": Array [],
          "from": "overview",
          "key": "overview",
          "name": Array [],
          "render": Array [],
          "tag": "Room",
        },
        "name": Array [],
        "render": Array [],
      },
    ],
    "key": "overview",
    "tag": "Room",
  },
  "postFix": Object {
    "appearances": Array [
      Object {
        "children": Array [
          Object {
            "children": Array [],
            "data": Object {
              "tag": "Space",
            },
          },
          Object {
            "children": Array [],
            "data": Object {
              "tag": "String",
              "value": "Inactive",
            },
          },
        ],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "Test",
            "tag": "Asset",
          },
        ],
        "data": Object {
          "contents": Array [],
          "display": undefined,
          "key": "postFix",
          "tag": "Bookmark",
        },
        "render": Array [
          Object {
            "tag": "Space",
          },
          Object {
            "tag": "String",
            "value": "Inactive",
          },
        ],
      },
    ],
    "key": "postFix",
    "tag": "Bookmark",
  },
  "power": Object {
    "appearances": Array [
      Object {
        "children": Array [],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "Test",
            "tag": "Asset",
          },
          Object {
            "index": 0,
            "key": "Import-0",
            "tag": "Import",
          },
        ],
        "data": Object {
          "from": "basePower",
          "key": "power",
          "tag": "Variable",
        },
      },
    ],
    "default": undefined,
    "key": "power",
    "tag": "Variable",
  },
  "toggleActive": Object {
    "appearances": Array [
      Object {
        "children": Array [],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "Test",
            "tag": "Asset",
          },
        ],
        "data": Object {
          "key": "toggleActive",
          "src": "active = !active",
          "tag": "Action",
        },
      },
    ],
    "key": "toggleActive",
    "src": "active = !active",
    "tag": "Action",
  },
  "town": Object {
    "appearances": Array [
      Object {
        "children": Array [
          Object {
            "children": Array [
              Object {
                "children": Array [],
                "data": Object {
                  "tag": "String",
                  "value": "Waverly",
                },
              },
            ],
            "data": Object {
              "contents": Array [],
              "tag": "Name",
            },
          },
          Object {
            "children": Array [
              Object {
                "children": Array [],
                "data": Object {
                  "tag": "String",
                  "value": "The town of Waverly is a pleasant place to live.",
                },
              },
            ],
            "data": Object {
              "contents": Array [],
              "tag": "Description",
            },
          },
        ],
        "contextStack": Array [
          Object {
            "index": 0,
            "key": "Test",
            "tag": "Asset",
          },
        ],
        "data": Object {
          "contents": Array [],
          "key": "town",
          "name": Array [
            Object {
              "tag": "String",
              "value": "Waverly",
            },
          ],
          "render": Array [
            Object {
              "tag": "String",
              "value": "The town of Waverly is a pleasant place to live.",
            },
          ],
          "tag": "Knowledge",
        },
        "name": Array [
          Object {
            "tag": "String",
            "value": "Waverly",
          },
        ],
        "render": Array [
          Object {
            "tag": "String",
            "value": "The town of Waverly is a pleasant place to live.",
          },
        ],
      },
    ],
    "key": "town",
    "tag": "Knowledge",
  },
}
`;
